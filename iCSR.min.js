!function(e,t){function r(e,t){return typeof e===t}function n(e){return r(e,"object")}function i(e){return r(e,"number")}function o(e){return r(e,"string")}function a(e){return r(e,"function")}function s(e){return"undefined"==typeof e||"undefined"===e}function l(e,t){return n(e)&&e.hasOwnProperty(t)}function c(e){return t.getElementById(e)}e.iCSR={_LICENSE:" Creative Commons Attribution License - iCSR by 365CSI (http://iCSR.github.io)",_VERSION:"1.5.1",_Templates:[],_DEMO:!0,ReloadCSSforeveryItem:!0,TemplateManager:{},Items:{},SP:{},fn:{},Control:{},Str:{},Date:{},Array:{},Object:{},CSS:{},Tokens:{functions:{}},DOM:{fn:{},Control:{}},Color:{_CONTRAST:!0,_CONTRASTDARK:"inherit",_CONTRASTLIGHT:"gainsboro",_MISSING:"beige/red/1px dashed red",msYellow:"#FFB700",msRed:"#F02401",msBlue:"#219DFD",msGreen:"#77BC00"},CFG:{tracing:!0},interactive:!0},window.GetAncestor=function(e,t){for(;null!==e&&e.tagName!==t;)e=e.parentNode;return e};var u=e.iCSR,d=u.TemplateManager,p=u.Tokens,f=u.Object,g=u.CSS,m=u.DOM,h="";window.iCSR=u,u._traceheader=function(e){},u.trace=function(e,t,r,n,i,a,s,l,c,d,p,f,g,m,v){var b=h;o(e)&&(e=0,b=e);var C=[];C.push("background:#005AA9;color:#FCD500;font-weight:bold;"),C.push("background:green"),C.push("background:lightgreen"),C.push("background:lightcoral;"),C.push("background:indianred;"),C.push("background:red;");C[e];0===e&&(b+=t,t=h),u.CFG.ErrorCount<1&&u.CFG.tracing&&console&&u.tracelevel>=e},u.traceend=function(e,t,r,n,i,o,a,s,l,c,d,p,f,g,m){u.CFG.ErrorCount++,v(e,t,r,n,i,o,a,s,l,c,d,p,f,g,m)},u.traceerror=function(e,t,r,n,i,o,a,s){u.CFG.ErrorCount++,console},u.tracewarning=function(e,t,r,n,o,a,s,l){var c=!0;i(e)&&(c=e<=u.tracelevel),console&&c},u.traceon=function(e,t){return t&&u._traceheader(t),s(e)&&(e=1),u.tracelevel=e||0,u.CFG.tracing=!0,u.CFG.ErrorCount=0,v(0,"iCSR trace level "+u.tracelevel+" - template initialized - "+new Date),!0},u.traceoff=function(e){u.CFG.tracing=e?u.traceon(e):!1},u["catch"]=function(e,t,r){e.constructor===SyntaxError&&u.traceerror(t,"programming error!",r),u.traceerror(t,e.constructor.name,r,e)};var v=u.trace,b=u.tracewarning;window.iTrace=u.trace,window.iTraceWarning=u.tracewarning,u._RegisterDefaultTemplates=function(){u.Template("Example",function(){var e=this;e.color=e.colors[1],e.location="World",e.output="<div style='background:[color];'>[prefix] This is item: [value]</div>"},{colors:"red,yellow,blue",prefix:"Hello [location]!!!"}),u.Template("Status",function(){var e=this;e.color=e.colors[e.value],"Waiting on someone else"===e.value&&(e.value="Waiting"),e.value=u.Str.nobreak(e.value),e.output=e.style.container},{allowGroupHeader:!1,allowGridMode:!0,colors:{"Not Started":"lightgray",Deferred:"pink","Waiting on someone else":"gold","In Progress":"orange",Completed:"lightgreen"},width:"20px",height:"15px",padding:"padding:2px 1px 2px 1px;",divClass:"iCSR_Status_Container",Styles:{"default":{container:"<div class='[divClass]' style='background:[color];color:[textcolor]'>&nbsp;[value]&nbsp;</div>",CSS:{container:".[divClass] {font-size:[fontsize];height:[height];text-align:center;[padding]}"}},colortext:{container:"<div class='[divClass]' style='color:[color]'>&nbsp;[value]&nbsp;</div>",CSS:{container:".[divClass] {font-size:[fontsize];}"}},block:{container:"<div class='[divClass]'><div style='float:left;background:[color];width:[width]'>&nbsp;</div>&nbsp;[value]&nbsp;</div>",CSS:{container:".[divClass] {font-size:[fontsize];}"}}}}),u.Template("DueDate",function(){var e=this;if("number"!=typeof e.days)return void(e.output=e.datepicknodate);e.interactive||(e.datepicker=h),e.ranges=u.Color.extract(e.ranges);for(var t=0;Number(e.ranges[t+1])<e.days;)t+=2;e.color=e.ranges[t],e.days<0?e.label=e.labelPast:0===e.days?(e.absdays="",e.label=e.labelToday):e.days>0&&(e.label=e.labelFuture)},{allowGroupHeader:!1,allowGridMode:!0,ranges:"#f55,-21,#f7a,-14,#fab,-7,#fda,0,#cf9,7,#9fa",labelNodate:"No Date",labelToday:"today",labelFuture:"[absdays] days left",labelPast:"[absdays] days past",onclick:"onclick='{event.stopPropagation();}'",onchange:"onchange=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',new Date(this.value))\" ",width:"150px",mindate:"2000-12-31",datepicker_chrome:"[absdays] [label] <input type='date' min='[mindate]' [onclick] [onchange] value='[datepickervalue]' style='background:[color]'>",onclickSubtract:"onclick=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',iCSR.Date.add('[value]',-1))\" ",onclickAdd:"onclick=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',iCSR.Date.add('[value]',1))\" ",nextday:"next day",previousday:"previous day",setpreviousday:"<DIV class='[divClass]update [divClass]yesterday' [onclickSubtract]> [previousday] </DIV>",setnextday:"<DIV class='[divClass]update [divClass]tomorrow' [onclickAdd]> [nextday] </DIV>",datepicker:"<DIV class='iCSRdatepicker'>[setpreviousday] [setnextday]</DIV>",datepicknodate:"<div onclick=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',iCSR.Date.add(false,0))\" >[labelNodate]</div>",datedisplay:"<DIV class='iCSRdaycount'>[label]</DIV><DIV class='iCSRdate'>[value]</DIV>[datepicker]",divClass:"iCSR_DueDate_Container",Styles:{"default":{container:"<div class='[divClass]' style='background:[color]'>[datedisplay][[onDOMload]]</div>",CSS:{container:".[divClass] {width:[width];color:[textcolor];height:[height];padding:-2px 2px 0px 2px}",daycount:".iCSRdaycount {position:relative;float:left;}",date:".iCSRdate {position:relative;float:right;}",datepicker:".iCSRdatepicker {position:relative;z-index:3;width:100%;height:[height]}",dayselect:".[divClass]tomorrow,.[divClass]yesterday {display:block;font-size:14px;position:absolute;width:60%}",yesterday:".[divClass]yesterday {left:0%}",tomorrow:".[divClass]tomorrow {right:0%;text-align:right}",update:".[divClass]update {width:20px;height:[height];font-weight:bold;opacity:0}",updatehover:".[divClass]update:hover {color:white;font-weight:bold;opacity:1;cursor:pointer;background:grey}",input:".[divClass]>input {width:125px;border:none;margin-top:-4px;}"}}}}),u.Template("Priority",function(){var e=this,t=0,r=e.Choices.map(function(r,n){return e.nr=String(n),e.choice=r,e.color=e.colors[r],e.click="",e.value===r?(t=n,e.classname=e.Classcurrent,e.label=e.shortlabel):(e.click=e.clickupdate,e.classname=e.Classchoice,e.label="&nbsp;&nbsp;"),e.interactive||(e.classname+=" NonInteractive"),e.$replacetokens(e.style.item)});e.interactive&&r[t].indexOf("onclick")>-1?e.choices=r:e.choices=r[t]},{colors:"[msRed]/black,[msYellow],[msGreen]",width:"110px",widthCurrent:"50%",widthChoice:"15px",divClass:"iCSRpriority_Container",Classcurrent:"iCSRpriority_Current",Classchoice:"iCSRpriority_Choice",clickupdate:"iCSR.SP.UpdateItem(this,'[ID]','[Name]','[choice]');",layouts:"/_layouts/15/images/",style:"iCSRbar",Styles:{"default":{container:"<div class='[divClass]'>[choices]</div>",item:'<span class="[classname]" style="color:[color]" onclick="[click]">[label]</span>',CSS:{container:".[divClass] {}",containerDiv:".[divClass]>div {position:relative;float:left;}",choice:".[Classchoice] {cursor:pointer;opacity:.2}",choicehover:".[Classchoice]:hover {opacity:1;border-color:black}"}},iCSRbar:{item:'<div class="[classname]" style="background:[color]" onclick="[click]">[label]</div>',CSS:{container:".[divClass] {width:[width];}",containerDiv:".[divClass]>div {position:relative;float:left;display:inline;border:1px solid grey}",currenttext:".[Classcurrent] {font-size:[fontsize];color:[textcolor]}",currentlabel:".[Classcurrent] {width:[widthCurrent];text-align:center;padding:2px;}",currentnoninteractive:".[Classcurrent].NonInteractive {width:100%}",choice:".[Classchoice] {width:[widthChoice];cursor:pointer;opacity:.4}",choicehover:".[Classchoice]:hover {opacity:1;border-color:black}"}},kpi1:{container:"<div class='[divClass]'>[choices]</div>",item:'<span class="[classname]" onclick="[click]"><img src="[layouts]/kpidefault-[nr].gif"></span>'},kpi2:{item:"<span class='[classname]' onclick=\"[click]\"><img src='[layouts]/kpipeppers-[nr].gif'></span>"},kpi3:{item:"<span class='[classname]' onclick=\"[click]\"><img src='[layouts]/kpipepperalarm-[nr].gif'></span>"},kpi4:{item:"<span class='[classname]' onclick=\"[click]\"><img src='[layouts]/kpinormal-[nr].gif'></span>"}}}),u.Template("PercentComplete",function(){var e=this,t=[100,90,80,70,60,50,40,30,20,10];e.bars=t.map(function(t,r){return e.nr=String(r),e.percentage=t,e.label=t,e.click="",e.barclass="pastProgress",t>e.valuenr?(e.click=e.onclick,e.updatevalue=t/100,e.barclass="newProgress"):t===e.valuenr&&(e.barclass="currentProgress"),e.$replacetokens(e.style.item)}),e.valuenr>0&&(e.updatevalue=0,e.bars.push("<div class='resetProgress' [onclick]>[resettext]</div>")),e.output=e.style.container},{background:"lightgrey",scalecolor:"grey",scalesize:"75%",barcolor:"#0072C6",color:"beige",colorhover:"beige",barcolorhover:"green",onclick:"onclick=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]','[updatevalue]')\" ",percentsign:"<span style='display:inline-block;text-align:right;font-size:70%'>&nbsp;%</span>",rangecolor:"inherit",rangelabelcolor:"inherit",resettext:" reset to 0 ",rangelabel:"<span style='color:[rangelabelcolor];display:inline-block;text-align:right;width:20px'>[valuenr]</span>[percentsign]",onchange:" onchange=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',String(Number(this.value)/100) )\" ",oninput:' oninput="this.nextSibling.innerHTML=this.value;" ',width:"160px",height:"15px",rangeheight:"24px",CSSinset:"border-radius:1px;box-shadow: 0 2px 5px rgba(0, 0, 0, 0.25) inset;",divClass:"pbar",Styles:{"default":{container:"<div id='[templateid]' class='[divClass]'>[bars]</div>",item:"<div class='[barclass]' style='width:[percentage]%' [click]>[label]</div>",CSS:{container:".[divClass] {width:[width];height:[height];position:relative;background:[background]}",scale:".[divClass] {font-family:arial;font-size:11px;color:[scalecolor]}",bar:".[divClass]>div {position:absolute;text-align:right;font-size:[scalesize];height:100%;}",barscale:".[divClass]>div {border-right:1px solid #aaa;}",hover:".[divClass]>div:not(.currentProgress):hover{color:[colorhover];font-size:100%;background:[barcolorhover];z-index:4;cursor:pointer;opacity:.8}",hoverbefore:".[divClass]>div:not(.currentProgress):hover:before{content:'►';font-weight:bold}",currentpercent:".[divClass]>div:hover:after,.[divClass] .currentProgress:after{content:'%'}",current:".[divClass] .currentProgress{font-size:100%;z-index:3}",barcolor:".[divClass] .currentProgress{background:[barcolor];color:[color];[CSSinset]}",reset:".[divClass] .resetProgress{z-index:3;width:10%;height:[height];overflow:hidden;border-right:0px;color:transparent;padding:0 3px}",resethover:".[divClass] .resetProgress:hover{width:auto}"}},progress:{container:"<div style='white-space:nowrap'><progress class='[divClass]' value='[valuenr]' max='100'></progress> [value]</div>",CSS:{container:".[divClass] {height:[height];background:[background];color:[barcolor]}",bar:".[divClass]::-webkit-progress-value {background:[barcolor];[CSSinset]}",inset:".[divClass]::-webkit-progress-bar {background:[background];[CSSinset]}",animwk:"@-webkit-keyframes animate-stripes {100% {background-position: -100px 0px;}}",anim:"@keyframes animate-stripes {100% {background-position: -200px 0px;}}",animation1:".[divClass]::-webkit-progress-bar {-webkit-animation: animate-stripes 5s linear infinite;}",animation2:".[divClass]::-webkit-progress-bar {animation: animate-stripes 5s linear infinite;}"}},range:{container:"<div style='white-space:nowrap;background:[rangecolor];height:[rangeheight];margin-top:-5px'><input id='[id]' type='range' [oninput] [onchange] min='0' value='[valuenr]' max='100' step=10>[rangelabel]</div>",CSS:{container:".[divClass] {height:[height];background:[background]}",inset:".[divClass]::-webkit-progress-bar {background:#eee;border-radius:2px;box-shadow: 0 2px 5px rgba(0, 0, 0, 0.25) inset;}",animwk:"@-webkit-keyframes animate-stripes {100% {background-position: -100px 0px;}}",anim:"@keyframes animate-stripes {100% {background-position: -200px 0px;}}",animation1:".[divClass]::-webkit-progress-bar {-webkit-animation: animate-stripes 5s linear infinite;}",animation2:".[divClass]::-webkit-progress-bar {animation: animate-stripes 5s linear infinite;}"}}}})},d.CreateTemplate=function(e,t,r){b("Created iCSR Template: iCSR."+e),r.templateid=e,r.templateCSSid="CSS_"+e,u[e]=function(t){if(l(t,"CurrentFieldSchema")){v(2,"Execute iCSR."+e);var n=u.fn._get_configTemplate(t,r,this);return n.id=n.templateid+"_"+n.ID,d._injectconfigTemplateFunctions(n),t&&t.inGridMode&&!n.allowGridMode?(t.ListSchema.Field.AllowGridEditing=!1,n.value):u.SP.isGroupHeader(t)&&n.allowGroupHeader?n.value:(u.fn._preprocessTemplate(n),g._appendTemplateCSS(n.style.CSS,n),u[e].Rows.push(n),u[e].executeTemplate.call(n,t),d._postprocessTemplateOutput(n),n.output)}return v(2,"Returning function REFERENCE for:"+e),u[e].bind(t)}},u.Me=function(e){try{if(!l(e,"view"))return v(3,"CSR Function Reference declared as Function call."),u.Me.bind(e);if(null!==e.CurrentFieldSchema){var t=e.CurrentFieldSchema.FieldType,r=e.CurrentFieldSchema.RealFieldName;if(u.$hasTemplate(r))return u[r].call(this,e);var n="No Template for: iCSR."+r;b(n,"("+t+")"),u.SPStatus(n,"yellow","iCSR:",!1,!0)}else if(null!==e.ListSchema){var i=i||{};return f._ensure_object_key_value(i,"Templates",{}),f._ensure_object_key_value(i.Templates,"Fields",{}),e.ListSchema.Field.forEach(function(e){u.$hasTemplate(e.RealFieldName)&&(f._ensure_object_key_value(i.Templates.Fields,e.RealFieldName,{}),f._ensure_object_key_value(i.Templates.Fields[e.RealFieldName],"View",u.Me))}),i}}catch(o){u.traceerror(o),u.SPStatus(o.message,"red","iCSR error:",!1,!0)}},d.RegisterFunction=function(e,t){var r="New ";u.$hasTemplate(e,!0)&&(r=h),v(1,r+"RegisterFunction",e),u[e].executeTemplate=t},d.RegisterTemplate=function(e,t,r){e=d._validateTemplateName(e),t=d._validateTemplateFunction(t),r=d._validateTemplateConfiguration(r),v(0,"_$TemplateManager.RegisterTemplate",e,{templateconfig:r});var n=!0;n&&(d.CreateTemplate(e,t,r),u[e].configuration=r,u[e].Rows=[]),d.RegisterFunction(e,t,r),u[e].$style=function(){var t=u[e].configuration;f.list(t.Styles,t.templateid+" predefined Styles:")},u[e].$CSS=function(){var t=u[e].configuration;g.listRules(t.templateCSSid)},u[e].$Rows=function(){var t=u[e];b(t.Rows.length,"Rows in this template",t.Rows),f.list(t.Rows[0],t.Rows[0].id)},u[e].$config=function(t,r){var n="iCSR."+e+" tokens (excluding the tokens created by each listitem)",i=u[e].configuration,o=!1;return s(t)?(o=!0,r=i):(r=f.gettersetter(i,t,r),o=s(r)),o&&(f.list(i,n),t&&b("Missing configuration key, you used: "+n+".$config","(",t,",",r,")")),r},u.defineProperty("ic"+e+"_config",window,u[e].$config),u.defineProperty("ic"+e+"_styles",window,u[e].$style),u._Templates.push(e)},u.Template=d.RegisterTemplate,d.hasTemplate=function(e,t){var r=l(u,e);return r||t||b("There is no Template:",e),r},u.$hasTemplate=d.hasTemplate,d._validateTemplateName=function(e){return e},d._validateTemplateFunction=function(e){return e},d._postprocessTemplateOutput=function(e){e.$ensuretoken("onDOMloadFunctions",[]),u.tracingcolors;var t="backgroundColor:'[combocolor]'";e.rowcolor&&e.onDOMloadFunctions.push("{iCSR.DOM.style(GetAncestor(this,'TR'),{"+t+"})}"),e.cellcolor&&e.onDOMloadFunctions.push("{iCSR.DOM.style(GetAncestor(this,'TD'),{"+t+"})}"),e.$ensuretoken("onDOMload","<[blankIMG] onload={[onDOMloadFunctions]}>"),e.output=e.$replacetokens(e.output),u.tracingcolors,v(1,"ID:",e.ID,e.templateid,"output:",u.tracelevel<3?{output:e.output,config:e}:e.output)},d._injectconfigTemplateFunctions=function(e){e.setcolor=function(e,t,r){var n=this.iid;t=t||this.color,r=r||this.counter,e=e||"TD",m.wait(n,function(){var i=c(n);if("TD"===e){i.cells[r]}else i.style.backgroundColor=t}.bind(this),10)}.bind(e),e.$replacetokens=p.replace.bind(e),e.$ensuretoken=p.ensureTokenexists.bind(e)},d._validateTemplateConfiguration=function(e){e=e||{divClass:"[templateid]"};var t={Styles:{"default":{container:"<div class='[divClass]' style='background:[color];color:[textcolor]'>&nbsp;[value]&nbsp;[onDOMload]</div>",CSS:{container:".[divClass] {}"}}},textcolor:"contrast",fontsize:"11px",height:"20px",msYellow:u.Color.msYellow,msRed:u.Color.msRed,msBlue:u.Color.msBlue,msGreen:u.Color.msGreen,colors:"[msYellow],[msRed],[msBlue],[msGreen]",gradient7redgreen:["indianRed","lightCoral","Pink","lightGoldenrodYellow","lightGreen","mediumSeaGreen","limeGreen"],EditLabel:"Edit",EditLink:"<a href='[urlEdit]' title='Edit [Name]'>[EditLabel]</a>",layouts:"/_layouts/images/"};Object.keys(t).forEach(function(r){f._ensure_object_key_value(e,r,t[r])});var r="edititem,loading16,loading,opendb,Progress,star,TXT16";return u.Array.ensure(r).forEach(function(t){f._ensure_object_key_value(e,t,"[layouts]img"+t+".gif")}),e.blankIMG="img src='/_layouts/images/blank.gif' ",e.blankIMG="img src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7' ",e.output=e.Styles["default"].container,e},u.init=function(){SP?(u._traceheader(!1),SP.SOD.executeFunc("clienttemplates.js","SPClientTemplates",function(){})):u.traceerror("no SharePoint environment")},p.fromStr=function(e,t){var r=e;if(o(r)){var n=["(.+?)"];t=t||"[]";var i=parseInt(t.length/2);t=t.match(new RegExp(".{1,"+i+"}","g")),2===t.length?(n.unshift("\\"+t[0]),n.push("\\"+t[1]),r=e.split(new RegExp(n.join(h),"g")),v(4,"_$Tokens.fromStr with: ",t,e,r)):u.traceerror("invalid _tokenidentifier",t)}else b("_$Tokens.fromStr with: ",e);return r},p.replacetoken=function(e,t,r){var i=e;if(i!==h&&"."!==i&&"iCSR"!==i){if(l(t,e)&&(i=t[e],p.hasfunction(e)&&(i=p.functions[e].call(t,i)),a(i)||n(i)&&Array.isArray(i)&&(i=i.join(h))),p.hasfunction(i)){var s=p.fromStr(e,"()"),c=s[0],d=s[1];v(1,"call: ",c,"(",d,")");var f=p.functions[c].call(t,d);o(f)&&u.traceerror("Token function must return a String, called:",c,d)}if(e===i){var g=e.split("."),m=g[0];if(l(t,m)){var b=g[1];i=t[m][b]}else u.Str.alphanumeric(e)===e&&r&&(i="["+e+"]",v(4,"replacetoken UNTOUCHED: ",i))}else i&&v(3,"replacetoken:",e,"\n==>",i)}return i},p._recursivereplace=function(e,t){function r(e){if(n++,n>1e3)return"**RECURSION LIMIT**";for(var o=0;o<e.length;o++){var a=e[o],s=e.substr(0,o),l=e.slice(o+1),c="\\"===e[o-1];if(c&&(e=s.slice(0,o-1)+a+l,a=!1),!c&&"]"===a){var u=h;if("?"===s?t.templateid&&f.list(t,"Available tokens for: "+t.templateid):(i=s,u=p.replacetoken(s,t,!1)),u!==s)return r(u+l);e=s+l}if("["===a){var d=r(l);e=s+d}}return e}var n=0,i="";return r(e)},p.replace=function(e,t){return t=t||this,p._recursivereplace(e,t)},p.ensureTokenexists=function(e,t){return f._ensure_object_key_value(this,e,t)},p.functions.svgcircle=function(e,t){t=t||"[color]";var r=e/2,n="<svg height="+e+" width="+e+">";return n+="<circle cx="+r+" cy="+r+" r="+r+" fill='"+t+"'/>",n+="</svg>"},p.functions.layoutsimage=function(e){return"<img src='/layouts/images/"+u.Str.alphanumeric(e)+".gif'/>"},p.hasfunction=function(e){var t=!1;return o(e)&&(e=e.split("(")[0],l(p.functions,e)&&(t=!0)),t},u.Str.nobreak=function(e){return e=e||h,e.replace(/ /gi,"&nbsp;")},u.Str.alphanumeric=function(e,t){return e.replace(/[^a-z0-9+]+/gi,t||h)},u.Str.number=function(e,t){if(!o(e))return e;var r=e.match(/\d+/);return r?r[0]:t},u.Str.label=function(e){var t=") ",r=e&&e.indexOf(t)>0?e.split(t)[1]:e;return r},u.Date.object=function(e){return o(e)&&(e=new Date(e)),e=e||new Date,e={yyyy:e.getFullYear(),MM:e.getMonth()+1,dd:e.getDate(),hh:e.getHours(),mm:e.getMinutes(),ss:e.getSeconds()},e.yy=String(e.yyyy).substring(2),e},u.Date.add=function(e,t,r,n){return e=e||new Date,e=u.Date.object(e),new Date(e.yyyy+(n?n:0),e.MM+(r?r:0)-1,e.dd+(t?t:0),e.hh,e.mm,e.ss)},u.Date.format=function(e,t){var r=!0;if(t=t||"yyyy-MM-dd",e=e||new Date,r)return String.format("{0:"+t+"}",e);e=u.Date.object(e);for(var n in e)if(l(e,n)){var i=new RegExp(n,"g");t=t.replace(i,e[n])}return t},u.Date.diff=function(e,t){return e=new Date(e),e instanceof Date&&!isNaN(e.valueOf())?GetDaysAfterToday(e,t||new Date):(v(4,"Incorrect Date conversion from:",e),!1)},u.Array.ensure=function(e,t){if(t=t||",",o(e)){if(e===h)return[];e=e.split(t)}return e},f={isFunction:function(e){return null!==e&&"function"==typeof e},isArray:function(e){return null!==e&&"array"==typeof e},isWindow:function(e){return null!==e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null===e?String(e):typeof e},isPlainObject:function(e){if(!e||"object"!==f.type(e)||e.nodeType||f.isWindow(e))return!1;try{if(e.constructor)return!1}catch(t){return!1}var r;for(r in e);return void 0===r},isEmpty:function(e){return Object.keys(e).lenght<=0},extend:function(){var e,t,r,n,i,o,a=arguments[0]||{},s=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,s=2),"object"==typeof a||f.isFunction(a)||(a={}),c===s&&(a=this,--s);c>s;s++)if(null!==(i=arguments[s]))for(n in i)if(l(i,n)){if(e=a[n],r=i[n],a===r)continue;u&&r&&(f.isPlainObject(r)||(t=f.isArray(r)))?(t?(t=!1,o=e&&f.isArray(e)?e:[]):o=e&&f.isPlainObject(e)?e:{},a[n]=f.extend(u,o,r)):void 0!==r&&(a[n]=r)}return a}},f.extendbyname=function(e,t,r){r=r||Object.keys(t),r=u.Array.ensure(r);var n={};r.forEach(function(e){l(t,e)?n[e]=t[e]:(n[e]="undefined",b(3,"Missing:",e," in:",t))}),f.extend(e,n)},f.gettersetter=function(e,t,r){var n=e[t];return s(r)?n:(l(e,t)&&(e[t]=r),e[t])},f._ensure_object_key_value=function(e,t,r){return l(e,t)?r=e[t]:e[t]=r,r},f.list=function(e,t,r){e&&(r=r||t,b("Object Inspector:",t||h),f.isEmpty(e)?b("Empty object"):Object.keys(e).forEach(function(e,t){}),b("Object Inspector:",r||h))},u.fn._get_configFrom_Colors=function(e,t){s(t.colors)||""===t.colors?b("Empty .colors"):(t.colors=p.replace(t.colors,t),t.colors=u.Color.extract(t.colors,t.Choices))},u.fn._get_configFrom_FieldType=function(e,t){if("DateTime"===t.FieldType){var r=new Date(t.value);t.days=u.Date.diff(t.value),t.datepickervalue=u.Date.format(r,"yyyy-MM-dd"),t.absdays=Math.abs(t.days),t.Monthname=String.format("MMMM",r),t.emptydate=isNaN(t.days),t.emptydate&&(t.days=!1,t.absdays=!1)}},u.fn._get_configFrom_ctx=function(e,t){e?(f.extendbyname(t,e.CurrentFieldSchema,"Name,DisplayName,RealFieldName,FieldType,counter,Choices"),f._ensure_object_key_value(t,"Item",e.CurrentItem),t.ID=e.CurrentItem.ID,t.iid=GenerateIID(e),l(e.CurrentItem,t.Name)?t.value=e.CurrentItem[t.Name]:t.value=e.CurrentItem[t.RealFieldName],t.itemid="iCSR_"+e.wpq+"_"+t.ID,t.daysCreated=u.Date.diff(e.Created),t.daysModified=u.Date.diff(e.Modified),t.urlEdit=e.editFormUrl+"&ID="+t.ID,t.urlDisplay=e.displayFormUrl+"&ID="+t.ID):(t.ID="no ctx",t.iid=!1,t.value="no ctx value")},u.fn._get_configFrom_pageContextInfo=function(e){var t=window._spPageContextInfo;t&&f.extendbyname(e,t,"userId,userLoginName,webPermMask,pageListId,isSiteAdmin,hasManageWebPermissions,siteAbsoluteUrl,serverRequestPath"),e.urlList=t.serverRequestPath.replace(/[^\/]*$/gi,"")},u.fn._get_configTemplate=function(e,t,r){var n={templateid:h,ID:0,Name:"none",value:!1,valuenr:!1,label:!1,shortlabel:!1,id:0,itemid:"none",color:"poep",textcolor:"pies",colors:h};try{return r=l(r,"FieldType")?{}:r,f.extend(n,t),f.extend(n,r),l(u,"interactive")&&(n.interactive=u.interactive,l(r,"interactive")&&(n.interactive=r.interactive)),u.fn._get_configFrom_ctx(e,n),u.fn._get_configFrom_pageContextInfo(n),n.valuenr=Number(u.Str.number(n.value,!1)),n.shortlabel=n.valuenr?u.Str.label(n.value):n.value,n.label=n.shortlabel,n.nonbreaklabel=u.Str.nobreak(n.shortlabel),n.emptystring=n.value===h,u.fn._get_configFrom_FieldType(e,n),u.fn._get_configFrom_Colors(e,n),n}catch(i){u.traceerror("_get_configTemplate error",i,"\nsuccesfull config declarations:",n)}},u.fn._preprocessTemplate=function(e){v(3,"_preprocessTemplate",{output:e.style});var t=l(e.Styles,e.style),r=e.Styles["default"];if(t){var n=e.Styles[e.style];f.extend(r,n)}else e.style&&(r.item=p.replace(e.style));return e.style=r,r},u.fn.addItem=function(e){var t=e.Name;l(u.Items,t)||(u.Items[t]=[]),u.Items[t].push(e.value)},u.fn.fixedListViewHeader=function(){},g.appendHEADstyle=function(e){var r=t.createElement("STYLE");return r.id=e,r.appendChild(t.createTextNode(h)),t.head.appendChild(r),v(2,"added stylesheet",r.id),r},g.insertRuleinStyleSheet=function(e,t){if(e)try{e.sheet.insertRule(t,0)}catch(r){b(1,"ignoring CSS definition:",t)}else u.traceerror("Not a STYLE sheet",e)},g.addStyleRules=function(e,t){try{var r=c(e);(u.ReloadCSSforeveryItem||!r)&&(u.ReloadCSSforeveryItem&&r&&m.remove(r),r=g.appendHEADstyle(e),t.forEach(function(e){g.insertRuleinStyleSheet(r,e)}))}catch(n){u["catch"](n,"_$CSS.addStyleRules",e,t)}},g._appendTemplateCSS=function(e,t){var r=t.rules||[];return e=e||!1,o(e)&&(e=t.Styles[e]),e?(Object.keys(e).forEach(function(n){r.push(p.replace(e[n],t))}),g.addStyleRules(t.templateCSSid,r,!0),v(2,"CSS:",e)):u.traceerror("Missing CSS _config.Styles:",e),e},g.listRules=function(e){var t=[],r=c(e);if(r){var n=r.sheet.cssRules;b("CSS Rules for: ",e),Object.keys(n).forEach(function(e){var r=n[e];t.push(r.cssText)})}else b("There is no CSS STYLE definition for:",e);return t},u.SP.SPStatuscount=0,u.SPStatus=function(e,t,r,n,i){SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){var o=SP.UI.Status;if(e&&0!==t||o.removeAllStatus(!0),e){var a;u.SP.SPStatuscount++,10===u.SP.SPStatuscount?(a=o.addStatus("iCSR","Too many errors",!1),o.setStatusPriColor(a,"red")):u.SP.SPStatuscount<10&&(a=o.addStatus(r||"iCSR Demo",e,n||!1),o.setStatusPriColor(a,t||"yellow"),i||window.setTimeout(function(){u.SP.SPStatuscount--,o.removeStatus(a)},5e3))}})},u.SP.UpdateListItem=function(e,t,r,n,i,o){var a=event;a&&a.preventDefault(),a&&a.stopPropagation(),e=e||SP.ListOperation.Selection.getSelectedList();var s=SP.ClientContext.get_current(),l=s.get_web(),c=l.get_lists().getById(e),d=c.getItemById(t);s.load(d),d.set_item(r,n),d.update(),i=i||function(){v(1,"success SP.UpdateListItem",t,r,n),u.SP.refreshView()},o=o||function(){u.traceerror("Error Updating")},s.executeQueryAsync(i,o)},u.SP.UpdateItem=function(e,t,r,n){GetAncestor(e,"TD").style.opacity=".1",u.SP.UpdateListItem(!1,t,r,n)},u.SP.setAuthor=function(e,t){var r=new SP.ClientContext.get_current,n=r.get_web().get_lists().getById(SP.ListOperation.Selection.getSelectedList()),i=n.getItemById(e);r.load(i),i.set_item("Author",t),i.update(),r.executeQueryAsync(function(){u.SP.refreshView()},function(e,t){u.traceerror(t.get_message())})},u.SP.refreshView=function(e,t){e=e||ctx,e&&(e.skipNextAnimation=!t||!0,AJAXRefreshView({currentCtx:e,csrAjaxRefresh:!0},1))},u.SP.renderHeaderTemplate=function(e,t){var r=JSON.parse(e.ListSchema.ViewSelectorPivotMenuOptions);return ClientPivotControl.prototype.SurfacedPivotCount=r.length-3,RenderHeaderTemplate(e,t)},u.SP.isGroupHeader=function(e){return e?l(e.CurrentItem,e.CurrentFieldSchema.Name+".COUNT.group"):void 0},p.functions.color=function(e){var t=this;i(e)&&(e=t.colors[e]);var r=u.Color._getcolorObject(e,t.textcolor);if(t.combocolor=e,t.color=r.background,u.tracingcolors,"contrast"===r.textcolor){var n=u.Color.contrastcolor(t.color);n&&(r.textcolor=n),u.tracingcolors}return t.textcolor=r.textcolor,"inherit"!==r.textcolor&&(u.tracingcolors,r.background=r.background+";color:"+t.textcolor+";"),u.tracingcolors,r.background},u.Color._getcolorObject=function(e,t){o(e)||(e=u.Color._MISSING);var r=e.split("/");return u.tracingcolors,r[1]?t=r[1]:t||(t="inherit"),u.tracingcolors,{background:r[0],textcolor:t,border:r[2]}},u.Color.contrastcolor=function(e,t){var r=e,n=!1;return t&&"#"!==r[0]&&(r=window.getComputedStyle(t).backgroundColor,"rgb(240, 36, 1)"===r&&(r="#000"),"rgba(0, 0, 0, 0)"===r&&"none"!==e&&"transparent"!==e&&(r=!1)),r&&(n=u.Color[u.Color.contrast(r)],u.tracingcolors),n||!1},u.Color.extract=function(e,t){if(t=t||!1,"undefined"===t&&(t=!1),u.tracingcolors,o(e)&&!s(e)){var r=e.split(",");if(t){e={};for(var n=0;n<t.length;n++){var i=t[n],a=r[n];a||(a="beige"),e[i]=a}}else e=r}return e},u.Color.contrast=function(e){if(void 0===e||""===e)return null;var t,r,n,i,o=/^rgba?[\s+]?\(\s*(([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]))\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,?(?:\s*([\d.]+))?\s*\)?\s*/im,a=/^(?:#)|([a-fA-F0-9]{3}|[a-fA-F0-9]{6})$/gim,s=e.match(o),l=e.match(a);if(s)t=parseInt(s[1],10),r=parseInt(s[2],10),n=parseInt(s[3],10);else{if(!l)return null;l=l.length>1?l[1]:l[0],3===l.length&&(l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]),t=parseInt(l.substr(0,2),16),r=parseInt(l.substr(2,2),16),n=parseInt(l.substr(4,2),16)}return i=(299*t+587*r+114*n)/1e3,i>=128?"_CONTRASTDARK":"_CONTRASTLIGHT"},u.Color.cell=function(e,t){e.style.backgroundColor=t.background,e.style.color=t.textcolor,t.textcolor||(t.border="1px dashed red"),t.border&&(e.style.border=t.border)},u.Color.row=function(e,t){var r,n=e.getElementsByTagName("a");for(r=0;r<n.length;r++)n[r].style.color=t.textcolor;for(n=e.getElementsByTagName("td"),r=0;r<n.length;r++)u.Color.cell(n[r],t)},u.DOM.style=function(e,t){Object.keys(t).forEach(function(r){var n=t[r];if("backgroundColor"===r){var i=u.Color._getcolorObject(n);e.style.backgroundColor=i.background,u.tracingcolors,window.setTimeout(function(){u.Color._CONTRAST&&(i.textcolor=u.Color.contrastcolor(i.background,e)),u.tracingcolors,"TD"===e.tagName?u.Color.cell(e,i):u.Color.row(e,i)},10)}else e.style[r]=n})},m.wait=function(e,t,r){var n=c(e);n?setTimeout(t.bind(null,n),0):0>r?u.traceerror("_$DOM.wait failed:",e):setTimeout(m.wait.bind(null,e,t,r-1),r||100)},m.appendHTML=function(e,r,n,i){var o=t.createElement(n||"DIV");return o.innerHTML=r,o.className=i||h,e.appendChild(o)},m.remove=function(e){o(e)&&(e=c(e)),e.parentNode.removeChild(e)},m.footer=function(e){e=e||"Download iCSR.js from iCSR.github.io ► the iCSR.js file you linked to is for demo use only! ( version: "+u._VERSION+" )";var r=["body::after{color:#FCD500;background:#005AA9;content:'"+e+"';position:fixed;bottom:30px;width:100%;left:0px;font-size:16px;text-align:center;}",".iCSRlogo {position:fixed;bottom:50px;left:30px;width:96px;height:96px;z-index:1}",".helplinks {width:300px}"];g.addStyleRules("iCSR",r);var n="<h3>Support Links:</h3>";n+="<a href='https://github.com/365CSI/iCSR/blob/master/CSR-5-minute-quickstart.md' target='_new'>iCSR Quickstart</a>",n+="<br><a href='http://iCSR.github.io' target='_new'>iCSR on GitHub</a>",n+="<br><a href='http://davidbau.com/colors/' target='_new'>HTML colornames</a>",n="<div class='helplinks'>"+n+"</div>";var i="<table><tr><td><img src='https://365csi.nl/iCSR/ipcountlogo'></td><td valign='top'>"+n+"</td></tr></table>";m.wait("contentRow",function(){m.appendHTML(t.body,i,"DIV","iCSRlogo")},50)},u.Control.attachAllOption=function(e,r){r=r||"All "+e;var n=this,i="selectAll_"+e,o=c(i);if(this.elements=t.querySelectorAll("input[id^="+e+'][id*="MultiChoiceOption"]'),this.options=[].map.call(this.elements,function(e){return e}),this.selectall=function(){var e=this.checked;n.options.forEach(function(t){t.checked=e})},!o){var a=t.createElement("TR");a.innerHTML=String.format("<td><input id='{0}' type='checkbox'><label for='{0}'>{1}</label></td>",i,r),GetAncestor(this.options[0],"TBODY").appendChild(a)}o=c(i),o.addEventListener("click",this.selectall)},u.Control.table=function(e){function t(e){return e=n(e)?e:[e],e.map(function(e){return"string"==typeof e?r.columnNumbers[e]:e})}e=e||window.ctx;var r=this;r.table=c(e.clvp.tab.id),r.columnNumbers={},r.columns={},r.columnNames=e.ListSchema.Field.map(function(e){return r.columnNumbers[e.Name]=e.counter,r.columns[e.Name]={counter:e.counter,hidden:!1},e.Name}),r.actions=function(e,t,r){Array.prototype.slice.call(e.rows).forEach(function(e,n){t&&t(e),Array.prototype.slice.call(e.cells).forEach(function(e,t){r&&r(e,n,t)})})},r.hideheaders=function(e,t){var n=e?GetAncestor(e,"TABLE").firstChild:r.table.firstChild;t?n.style.visibility="hidden":n.style.display="none"},r.hideColumns=function(e,n){e=t(e),n=n||"none",r.actions(r.table,!1,function(t,i,o){var a=r.columnNames[o];e.indexOf(o)>-1&&(t.style.display=n,r.columns[a].hidden="none"===n)})},r.showColumns=function(){
r.hideColumns(r.columnNames,"table-cell")},r.colorColumns=function(e,t){r.actions(r.table,!1,function(n,i,o){e.indexOf(r.columnNames[o])>-1&&(n.style.backgroundColor=t)})},u.hideRows=function(e,t){}},u.Control.duplicates=function(e,r){var n=r?r.title:"Title",i=r?r.color:"ligthcoral",o=r?r.buttonlabel:["Show Duplicates","Hide Duplicates"],a=[],s=[],l=!0,u=t.createElement("BUTTON");e.ListData.Row.forEach(function(t){if(a.indexOf(t[n])>-1){var r=c(GenerateIIDForListItem(e,t));r.style.backgroundColor=i,s.push(r)}a.push(t[n])}),u.onclick=function(e){e.preventDefault(),l=!l,s.forEach(function(e){e.style.display=l?"table-row":"none"}),u.innerHTML=o[l/1]},c("CSRListViewControlDiv"+e.wpq).appendChild(u),u.click()},u.Object.info=function(e,t){var r={};return e.forEach(function(e){var n={};(t||"nofieldnames").split(",").forEach(function(t){var r=e[t];"Name"===t&&u.$hasTemplate(r,!0)&&(r+=" ==> iCSR.Me"),n[t]=r}),r[e.counter]=n}),r},u.defineProperty=function(e,t,r){t=t||window,l(t,e)||Object.defineProperty(t,String(e),{get:r})},window.icCTX||Object.defineProperty(window,"icCTX",{get:function(){return ctx?void 0:h}}),window.icTemplates||Object.defineProperty(window,"icTemplates",{get:function(){return u._Templates}}),window.cls||Object.defineProperty(window,"cls",{configurable:!0,get:function(){return h}}),u.overrides=function(e){return e=e||{},f._ensure_object_key_value(e,"Templates",{}),f._ensure_object_key_value(e.Templates,"Fields",{}),e.Templates.Fields.Priority={View:u.Me},e.Templates.Fields.DueDate={View:u.Me},e.Templates.Fields.Status={View:u.Me},e.Templates.Fields.PercentComplete={View:u.Me},e},l(u,"_DEMO")&&m.footer(),u.init(),u._RegisterDefaultTemplates(),SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("iCSR")}(window,document);