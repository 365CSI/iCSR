(function(global,document){global.iCSR={_LICENSE:"Creative Commons Attribution License - iCSR by 365CSI (http://iCSR.github.io)",_VERSION:"1.9.5",_Templates:[],ReloadCSSforeveryItem:true,tracelevel:0,TemplateManager:{},Items:{},SP:{},fn:{},Control:{},Str:{},Date:{},Array:{},Object:{},CSS:{},Tokens:{functions:{}},DOM:{fn:{},Control:{}},Color:{_CONTRAST:true,_CONTRASTDARK:_INHERIT,_CONTRASTLIGHT:"gainsboro",_MISSING:"beige/red/1px dashed red",msYellow:"#FFB700",msRed:"#F02401",msBlue:"#219DFD",msGreen:"#77BC00"},CFG:{tracing:true,ErrorCount:0,ErrorCountMax:1},interactive:true};window.GetAncestor=function(_element,tagType){while(_element!==null&&_element.tagName!==tagType)_element=_element.parentNode;return _element};var iCSR=global.iCSR,_$TemplateManager=iCSR.TemplateManager,_$Tokens=iCSR.Tokens,_$Object=iCSR.Object,_$CSS=iCSR.CSS,_$DOM=iCSR.DOM,_emptyString="",_UNDEFINED="undefined",_INHERIT="inherit",_RED="red",_YELLOW="yellow",_BACKGROUND="background",_ICSR="iCSR";window[_ICSR]=iCSR;window["iSP"]=iCSR.SP;function _$is(_obj,_something){return typeof _obj===_something}function _$isObject(_obj){return _$is(_obj,"object")}function _$isNumber(_obj){return _$is(_obj,"number")}function _$isString(_obj){return _$is(_obj,"string")}function _$isFunction(_obj){return _$is(_obj,"function")}function _$isUndefined(_obj){return typeof _obj===_UNDEFINED||_obj===_UNDEFINED}function _$hasProperty(_obj,key){return _$isObject(_obj)&&_obj.hasOwnProperty(key)}function _$getElementById(id){return document.getElementById(id)}iCSR._traceheader=function(_clearconsole){if(console&&_clearconsole)console.clear();if(console)console.info("%c iCSR.js - "+iCSR._VERSION+" ",_BACKGROUND+":#005AA9;color:#FCD500;font-weight:bold;font-size:20px;")};iCSR.trace=function(tracelevel,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15){var p1=_emptyString;if(_$isString(tracelevel)){tracelevel=-1;p1=tracelevel}if(tracelevel<1){p1=p1+p2;p2=_emptyString}var tracelevelcolor=[_BACKGROUND+":#005AA9;color:#FCD500;font-weight:bold;",_BACKGROUND+":green",_BACKGROUND+":lightgreen",_BACKGROUND+":lightcoral;",_BACKGROUND+":indianred;",_BACKGROUND+":red;"][Math.abs(tracelevel)];if(iCSR.CFG.ErrorCount<iCSR.CFG.ErrorCountMax){if(console&&iCSR.CFG.tracing&&iCSR.tracelevel>=tracelevel||tracelevel<0){console.info("%c iCSR "+"%c "+tracelevel+" "+p1+_emptyString,_BACKGROUND+":#005AA9;color:#FCD500;font-weight:bold;",tracelevelcolor,p2||_emptyString,p3||_emptyString,p4||_emptyString,p5||_emptyString,p6||_emptyString,p7||_emptyString,p8||_emptyString,p9||_emptyString,p10||_emptyString,p11||_emptyString,p12||_emptyString,p13||_emptyString,p14||_emptyString,p15||_emptyString)}}};iCSR.traceerror=function(p1,p2,p3,p4,p5,p6,p7,p8){iCSR.CFG.ErrorCount++;if(console)console.error("%c iCSR "+p1,_BACKGROUND+":lightcoral;color:black;",p2||_emptyString,p3||_emptyString,p4||_emptyString,p5||_emptyString,p6||_emptyString,p7||_emptyString,p8||_emptyString)};iCSR.tracewarning=function(p1,p2,p3,p4,p5,p6,p7,p8){var showwarning=true;if(_$isNumber(p1))showwarning=p1<=iCSR.tracelevel;if(console&&showwarning)console.warn("%c iCSR:"+p1,_BACKGROUND+":orange;color:brown",p2||_emptyString,p3||_emptyString,p4||_emptyString,p5||_emptyString,p6||_emptyString,p7||_emptyString,p8||_emptyString)};iCSR.traceon=function(_setlevel,_clearconsole){if(_clearconsole)iCSR._traceheader(_clearconsole);if(_$isUndefined(_setlevel))_setlevel=1;iCSR.tracelevel=_setlevel||0;iCSR.CFG.tracing=true;iCSR.CFG.ErrorCount=0;iTrace(0,"iCSR trace level "+iCSR.tracelevel+" - template initialized - "+new Date);return true};iCSR.traceoff=function(_setlevel){iCSR.CFG.tracing=_setlevel?iCSR.traceon(_setlevel):false};iCSR.catch=function(e,_functionname,functionreference){if(e.constructor===SyntaxError){iCSR.traceerror(_functionname,"programming error!",functionreference)}iCSR.traceerror(_functionname,e.constructor.name,functionreference,e)};var iTrace=iCSR.trace;var iTraceWarning=iCSR.tracewarning;window.iTrace=iCSR.trace;window.iTraceWarning=iCSR.tracewarning;iCSR._RegisterDefaultTemplates=function(){iCSR.Template("Example",function(){var example=this;example.color=example.colors[1];example.location="World";example.output="<div style='background:[color];'>[prefix] This is item: [value]</div>"},{colors:"red,yellow,blue",prefix:"Hello [location]!!!"});iCSR.Template("Status",function(){var status=this;status.color=status.colors[status.value];if(status.value==="Waiting on someone else")status.value="Waiting";status.value=iCSR.Str.nobreak(status.value);status.output=status.style.container},{allowGroupHeader:false,allowGridMode:true,colors:{"Not Started":"lightgray",Deferred:"pink","Waiting on someone else":"gold","In Progress":"orange",Completed:"lightgreen"},width:"20px",height:"15px",padding:"padding:2px 1px 2px 1px;",_Class:"iCSR_Status_Container",Styles:{"default":{container:"<div class='[_Class]' style='background:[color];color:[textcolor]'>&nbsp;[value]&nbsp;</div>",CSS:{container:".[_Class] {font-size:[fontsize];height:[height];text-align:center;[padding]}"}},colortext:{container:"<div class='[_Class]' style='color:[color]'>&nbsp;[value]&nbsp;</div>",CSS:{container:".[_Class] {font-size:[fontsize];}"}},block:{container:"<div class='[_Class]'><div style='float:left;background:[color];width:[width]'>&nbsp;</div>&nbsp;[value]&nbsp;</div>",CSS:{container:".[_Class] {font-size:[fontsize];}"}}}});iCSR.Template("DueDate",function(){var duedate=this;if(typeof duedate.days!=="number"){duedate.output=duedate.datepicknodate;return}if(!duedate.interactive){duedate.datepicker=_emptyString}duedate.ranges=iCSR.Color.extract(duedate.ranges);var colornr=0;while(Number(duedate.ranges[colornr+1])<duedate.days)colornr+=2;duedate.color=duedate.ranges[colornr];if(duedate.days<0){duedate.label=duedate.labelPast}else if(duedate.days===0){duedate.absdays="";duedate.label=duedate.labelToday}else if(duedate.days>0){duedate.label=duedate.labelFuture}},{allowGroupHeader:false,allowGridMode:true,ranges:"#f55,-21,#f7a,-14,#fab,-7,#fda,0,#cf9,7,#9fa",labelNodate:"No Date",labelToday:"today",labelFuture:"[absdays] days left",labelPast:"[absdays] days past",onclick:"onclick='{event.stopPropagation();}'",onchange:"onchange=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',new Date(this.value))\" ",width:"150px",mindate:"2000-12-31",datepicker_chrome:"[absdays] [label] <input type='date' min='[mindate]' [onclick] [onchange] value='[datepickervalue]' style='background:[color]'>",onclickSubtract:"onclick=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',iCSR.Date.add('[value]',-1))\" ",onclickAdd:"onclick=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',iCSR.Date.add('[value]',1))\" ",nextday:"next day",previousday:"previous day",setpreviousday:"<DIV class='[_Class]update [_Class]yesterday' [onclickSubtract]> [previousday] </DIV>",setnextday:"<DIV class='[_Class]update [_Class]tomorrow' [onclickAdd]> [nextday] </DIV>",datepicker:"<DIV class='iCSRdatepicker'>[setpreviousday] [setnextday]</DIV>",datepicknodate:"<div onclick=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',iCSR.Date.add(false,0))\" >[labelNodate]</div>",datedisplay:"<DIV class='iCSRdaycount'>[label]</DIV><DIV class='iCSRdate'>[value]</DIV>[datepicker]",_Class:"iCSR_DueDate_Container",Styles:{"default":{container:"<div class='[_Class]' style='background:[color]'>[datedisplay][[onDOMload]]</div>",CSS:{container:".[_Class] {width:[width];color:[textcolor];height:[height];padding:-2px 2px 0px 2px}",daycount:".iCSRdaycount {position:relative;float:left;}",date:".iCSRdate {position:relative;float:right;}",datepicker:".iCSRdatepicker {position:relative;z-index:3;width:100%;height:[height]}",dayselect:".[_Class]tomorrow,.[_Class]yesterday {display:block;font-size:14px;position:absolute;width:60%}",yesterday:".[_Class]yesterday {left:0%}",tomorrow:".[_Class]tomorrow {right:0%;text-align:right}",update:".[_Class]update {width:20px;height:[height];font-weight:bold;opacity:0}",updatehover:".[_Class]update:hover {color:white;font-weight:bold;opacity:1;cursor:pointer;background:grey}",input:".[_Class]>input {width:125px;border:none;margin-top:-4px;}"}}}});iCSR.Template("Priority",function(){var prio=this,currentchoice=0;var htmlparts=prio.Choices.map(function(choice,nr){prio.nr=String(nr);prio.choice=choice;prio.color=prio.colors[choice];prio.click="";if(prio.value===choice){currentchoice=nr;prio.classname=prio.Classcurrent;prio.label=prio.shortlabel}else{prio.click=prio.clickupdate;prio.classname=prio.Classchoice;prio.label="&nbsp;&nbsp;"}if(!prio.interactive)prio.classname+=" NonInteractive";return prio.$replacetokens(prio.style.item)});if(prio.interactive&&htmlparts[currentchoice].indexOf("onclick")>-1){prio.choices=htmlparts}else{prio.choices=htmlparts[currentchoice]}},{colors:"[msRed]/black,[msYellow],[msGreen]",width:"110px",widthCurrent:"50%",widthChoice:"15px",_Class:"iCSRpriority_Container",Classcurrent:"iCSRpriority_Current",Classchoice:"iCSRpriority_Choice",clickupdate:"iCSR.SP.UpdateItem(this,'[ID]','[Name]','[choice]');",layouts:"/_layouts/15/images/",style:"iCSRbar",Styles:{"default":{container:"<div class='[_Class]'>[choices]</div>",item:'<span class="[classname]" style="color:[color]" onclick="[click]">[label]</span>',CSS:{container:".[_Class] {}",containerDiv:".[_Class]>div {position:relative;float:left;}",choice:".[Classchoice] {cursor:pointer;opacity:.2}",choicehover:".[Classchoice]:hover {opacity:1;border-color:black}"}},iCSRbar:{item:'<div class="[classname]" style="background:[color]" onclick="[click]">[label]</div>',CSS:{container:".[_Class] {width:[width];}",containerDiv:".[_Class]>div {position:relative;float:left;display:inline;border:1px solid grey}",currenttext:".[Classcurrent] {font-size:[fontsize];color:[textcolor]}",currentlabel:".[Classcurrent] {width:[widthCurrent];text-align:center;padding:2px;}",currentnoninteractive:".[Classcurrent].NonInteractive {width:100%}",choice:".[Classchoice] {width:[widthChoice];cursor:pointer;opacity:.4}",choicehover:".[Classchoice]:hover {opacity:1;border-color:black}"}},kpi1:{container:"<div class='[_Class]'>[choices]</div>",item:'<span class="[classname]" onclick="[click]"><img src="[layouts]/kpidefault-[nr].gif"></span>'},kpi2:{item:"<span class='[classname]' onclick=\"[click]\"><img src='[layouts]/kpipeppers-[nr].gif'></span>"},kpi3:{item:"<span class='[classname]' onclick=\"[click]\"><img src='[layouts]/kpipepperalarm-[nr].gif'></span>"},kpi4:{item:"<span class='[classname]' onclick=\"[click]\"><img src='[layouts]/kpinormal-[nr].gif'></span>"}}});iCSR.Template("PercentComplete",function(){var progress=this;progress.percentage10s=Math.floor(progress.valuenr/10)*10;var bars=[100,90,80,70,60,50,40,30,20,10];progress.bars=bars.map(function(percentage,nr){progress.nr=String(nr);progress.percentage=percentage;progress.label=percentage;progress.click="";progress.barclass="pastProgress";if(percentage>progress.valuenr){progress.click=progress.onclick;progress.updatevalue=percentage/100;progress.barclass="newProgress"}else if(percentage===progress.percentage10s){progress.barclass="currentProgress"}return progress.$replacetokens(progress.style.item)});if(progress.valuenr>0){progress.updatevalue=0;progress.bars.push("<div class='resetProgress' [onclick]>[resettext]</div>")}progress.output=progress.style.container},{background:"lightgrey",scalecolor:"grey",scalesize:"75%",barcolor:"#0072C6",color:"beige",colorhover:"beige",barcolorhover:"green",onclick:"onclick=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]','[updatevalue]')\" ",percentsign:"<span style='display:inline-block;text-align:right;font-size:70%'>&nbsp;%</span>",rangecolor:"blue",rangelabelcolor:"inherit",resettext:"reset to 0",rangelabel:"<span style='color:[rangelabelcolor];display:inline-block;text-align:right;width:20px'>[valuenr]</span>[percentsign]",onchange:" onchange=\"iCSR.SP.UpdateItem(this,'[ID]','[Name]',String(Number(this.value)/100) )\" ",oninput:' oninput="this.nextSibling.innerHTML=this.value;" ',width:"160px",height:"15px",rangeheight:"24px",CSSinset:"border-radius:1px;box-shadow: 0 2px 5px rgba(0, 0, 0, 0.25) inset;",_Class:"pbar",Styles:{"default":{container:"<div id='[templateid]' class='[_Class]'>[bars]</div>",item:"<div class='[barclass]' style='width:[percentage]%' [click]>[label]</div>",CSS:{container:".[_Class] {width:[width];height:[height];position:relative;background:[background]}",scale:".[_Class] {font-family:arial;font-size:11px;color:[scalecolor]}",bar:".[_Class]>div {position:absolute;text-align:right;font-size:[scalesize];height:100%;}",barscale:".[_Class]>div {border-right:1px solid #aaa;}",hover:".[_Class]>div:not(.currentProgress):hover{color:[colorhover];font-size:100%;background:[barcolorhover];z-index:4;cursor:pointer;opacity:.8}",hoverbefore:".[_Class]>div:not(.currentProgress):hover:before{content:'►';font-weight:bold}",currentpercent:".[_Class]>div:hover:after,.[_Class] .currentProgress:after{content:'%'}",current:".[_Class] .currentProgress{font-size:100%;z-index:3}",barcolor:".[_Class] .currentProgress{background:[barcolor];color:[color];[CSSinset]}",reset:".[_Class] .resetProgress{z-index:3;width:10%;height:[height];overflow:hidden;border-right:0px;color:transparent;padding:0 3px}",resethover:".[_Class] .resetProgress:hover{width:auto}"}},progress:{container:"<div style='white-space:nowrap'><progress class='[_Class]' value='[valuenr]' max='100'></progress> [value]</div>",CSS:{container:".[_Class] {height:[height];background:[background];color:[barcolor]}",bar:".[_Class]::-webkit-progress-value {background:[barcolor];[CSSinset]}",inset:".[_Class]::-webkit-progress-bar {background:[background];[CSSinset]}"}},range:{container:"<div style='white-space:nowrap;background:[rangecolor];height:[rangeheight];margin-top:-5px'><input id='[id]' type='range' [oninput] [onchange] min='0' value='[valuenr]' max='100' step=10>[rangelabel]</div>",CSS:{container:".[_Class] {height:[height];background:[background]}",inset:".[_Class]::-webkit-progress-bar {background:#eee;[CSSinset]}"}}}});iCSR.Template("Planner",function(){this.color="[msBlue]";if(this.days<0)this.color="[msRed]";if(this.Item.Status==="Not Started")this.color="[msYellow]";if(this.Item.Status==="Completed")this.color="[msGreen]"},{rowcolor:1})};_$TemplateManager.CreateTemplate=function(_templateIDname,_templatefunction,_templateconfig){iTraceWarning("Created iCSR Template: iCSR."+_templateIDname);_templateconfig.templateid=_templateIDname;_templateconfig.templateCSSid="CSS_"+_templateIDname;iCSR[_templateIDname]=function(ctx){if(_$hasProperty(ctx,"CurrentFieldSchema")){iTrace(2,"Execute iCSR."+_templateIDname);var _config=iCSR.fn._get_configTemplate(ctx,_templateconfig,this);_config.id=_config.templateid+"_"+_config.ID;_$TemplateManager._injectconfigTemplateFunctions(_config);if(ctx&&ctx.inGridMode&&!_config.allowGridMode){ctx.ListSchema.Field.AllowGridEditing=false;return _config.value}if(iCSR.SP.isGroupHeader(ctx)&&_config.allowGroupHeader){return _config.value}iCSR.fn._preprocessTemplate(_config);_$CSS._appendTemplateCSS(_config.style.CSS,_config);if(_config.value[0]==="{"){try{var jsonvalue=JSON.parse(_config.value);_config.value=jsonvalue}catch(e){}}iCSR[_templateIDname].Rows.push(_config);iCSR[_templateIDname].executeTemplate.call(_config,ctx);_$TemplateManager._postprocessTemplateOutput(_config);if(_config.OnPostRender){_config.OnPostRender.call(_config,ctx)}return _config.output}else{iTrace(2,"Returning function REFERENCE for:"+_templateIDname);return iCSR[_templateIDname].bind(ctx)}}};iCSR.Me=function(ctx){if(_$hasProperty(ctx,"view")){if(ctx.CurrentFieldSchema!==null){var _fieldtype=ctx.CurrentFieldSchema.FieldType;var _fieldname=ctx.CurrentFieldSchema.RealFieldName;if(iCSR.$hasTemplate(_fieldname)){return iCSR[_fieldname].call(this,ctx)}var warning="No Template for: iCSR."+_fieldname;iTraceWarning(warning,"("+_fieldtype+")");iCSR.SPStatus(warning,_YELLOW,_ICSR,false,true)}else{if(ctx.ListSchema!==null){var _overrides=_overrides||{};_$Object._ensurevalue(_overrides,"Templates",{});_$Object._ensurevalue(_overrides.Templates,"Fields",{});ctx.ListSchema.Field.forEach(function(_field){if(iCSR.$hasTemplate(_field.RealFieldName)){_$Object._ensurevalue(_overrides.Templates.Fields,_field.RealFieldName,{});_$Object._ensurevalue(_overrides.Templates.Fields[_field.RealFieldName],"View",iCSR.Me)}});return _overrides}}}else{iTrace(3,"CSR Function Reference declared as Function call.");return iCSR.Me.bind(ctx)}};_$TemplateManager.RegisterFunction=function(_templateIDname,_templatefunction){var _prefix="New ";if(iCSR.$hasTemplate(_templateIDname,true)){_prefix=_emptyString}iTrace(1,_prefix+"RegisterFunction",_templateIDname);iCSR[_templateIDname].executeTemplate=_templatefunction};_$TemplateManager.RegisterTemplate=function(_templateIDname,_templatefunction,_templateconfig){_templateIDname=_$TemplateManager._validateTemplateName(_templateIDname);_templatefunction=_$TemplateManager._validateTemplateFunction(_templatefunction);_templateconfig=_$TemplateManager._validateTemplateConfiguration(_templateconfig);iTrace(2,"_$TemplateManager.RegisterTemplate",_templateIDname,{templateconfig:_templateconfig});var _createNewTemplate=true;if(_createNewTemplate){_$TemplateManager.CreateTemplate(_templateIDname,_templatefunction,_templateconfig);iCSR[_templateIDname].configuration=_templateconfig;iCSR[_templateIDname].Rows=[]}_$TemplateManager.RegisterFunction(_templateIDname,_templatefunction,_templateconfig);_$TemplateManager.RegisterChromeDEVconsoleFunctions(_templateIDname,_templatefunction,_templateconfig);iCSR._Templates.push(_templateIDname)};iCSR.Template=_$TemplateManager.RegisterTemplate;_$TemplateManager.RegisterChromeDEVconsoleFunctions=function(_templateIDname){if(iCSR.isChrome){iCSR[_templateIDname].$CSS=function(){var _config=iCSR[_templateIDname].configuration;_$CSS.listRules(_config.templateCSSid)};iCSR[_templateIDname].$Rows=function(){var _config=iCSR[_templateIDname];iTraceWarning(_config.Rows.length,"Rows in this template",_config.Rows);_$Object.list(_config.Rows[0],_config.Rows[0].id)};iCSR[_templateIDname].$config=function(_configKey,_value){var _title="iCSR."+_templateIDname+" tokens (excluding the tokens created by each listitem)";var _config=iCSR[_templateIDname].configuration;var _listconfig=false;if(_$isUndefined(_configKey)){_listconfig=true;_value=_config}else{_value=_$Object.gettersetter(_config,_configKey,_value);_listconfig=_$isUndefined(_value)}if(_listconfig){_$Object.list(_config,_title);if(_configKey)iTraceWarning("Missing configuration key, you used: "+_title+".$config","(",_configKey,",",_value,")")}return _value};iCSR.defineProperty("ic_"+_templateIDname+"_config",window,iCSR[_templateIDname].$config)}};_$TemplateManager.hasTemplate=function(_templateIDname,_silent){var _hasTemplate=_$hasProperty(iCSR,_templateIDname);if(!_hasTemplate&&!_silent){iTraceWarning("There is no Template:",_templateIDname)}return _hasTemplate};iCSR.$hasTemplate=_$TemplateManager.hasTemplate;_$TemplateManager._validateTemplateName=function(_templateIDname){return _templateIDname};_$TemplateManager._validateTemplateFunction=function(_templatefunction){return _templatefunction};_$TemplateManager._postprocessTemplateOutput=function(_config){_config.$ensuretoken("onDOMloadFunctions",[]);var _escapedstr="backgroundColor:'[combocolor]'";if(_config.rowcolor)_config.onDOMloadFunctions.push("{iCSR.DOM.style(GetAncestor(this,'TR'),{"+_escapedstr+"})}");if(_config.cellcolor)_config.onDOMloadFunctions.push("{iCSR.DOM.style(GetAncestor(this,'TD'),{"+_escapedstr+"})}");_config.$ensuretoken("onDOMload","<[blankIMG] onload={[onDOMloadFunctions]}>");_config.output=_config.$replacetokens(_config.output);iTrace(1,"ID:",_config.ID,_config.templateid,"output:",iCSR.tracelevel<3?{output:_config.output,config:_config}:_config.output)};_$TemplateManager._injectconfigTemplateFunctions=function(_config){_config.$replacetokens=_$Tokens.replace.bind(_config);_config.$ensuretoken=_$Tokens.ensureTokenexists.bind(_config)};_$TemplateManager._validateTemplateConfiguration=function(_config){_config=_config||{_Class:"[templateid]"};var _defaults={Styles:{"default":{container:"<div class='[_Class]' style='background:[color];color:[textcolor]'>&nbsp;[value]&nbsp;[onDOMload]</div>",CSS:{container:".[_Class] {}"}}},_Update:"iCSR.SP.UpdateItem(this,'[ID]','[Name]',[updatevalue])",_onclick:" onclick='{[_Update]}'",textcolor:"contrast",fontsize:"11px",height:"20px",msYellow:iCSR.Color.msYellow,msRed:iCSR.Color.msRed,msBlue:iCSR.Color.msBlue,msGreen:iCSR.Color.msGreen,colors:"[msYellow],[msRed],[msBlue],[msGreen]",gradient7redgreen:["indianRed","lightCoral","Pink","lightGoldenrodYellow","lightGreen","mediumSeaGreen","limeGreen"],EditLabel:"Edit",EditLink:"<a href='[urlEdit]' title='Edit [Name]'>[EditLabel]</a>",layouts:"/_layouts/images/"};Object.keys(_defaults).forEach(function(key){_$Object._ensurevalue(_config,key,_defaults[key])});var _layoutsimages="edititem,loading16,loading,opendb,Progress,star,TXT16";iCSR.Array.ensure(_layoutsimages).forEach(function(key){_$Object._ensurevalue(_config,key,"[layouts]img"+key+".gif")});_config.blankIMG="img src='/_layouts/images/blank.gif' ";_config.blankIMG="img src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7' ";_config.output=_config.Styles.default.container;return _config};_$Tokens.fromStr=function(_tokenstring,_tokenidentifier){var _tokenized=_tokenstring;if(_$isString(_tokenized)){var _regexArray=["(.+?)"];_tokenidentifier=_tokenidentifier||"[]";var _halflength=parseInt(_tokenidentifier.length/2);_tokenidentifier=_tokenidentifier.match(new RegExp(".{1,"+_halflength+"}","g"));if(_tokenidentifier.length===2){_regexArray.unshift("\\"+_tokenidentifier[0]);_regexArray.push("\\"+_tokenidentifier[1]);_tokenized=_tokenstring.split(new RegExp(_regexArray.join(_emptyString),"g"));iTrace(4,"_$Tokens.fromStr with: ",_tokenidentifier,_tokenstring,_tokenized)}else{iCSR.traceerror("invalid _tokenidentifier",_tokenidentifier)}}else{iTraceWarning("_$Tokens.fromStr with: ",_tokenstring)}return _tokenized};_$Tokens.replacetoken=function(_tokenstring,_tokenconfig,_islasttoken){var _tokenized=_tokenstring;if(_tokenized!==_emptyString&&_tokenized!=="."&&_tokenized!=="iCSR"){if(_$hasProperty(_tokenconfig,_tokenstring)){_tokenized=_tokenconfig[_tokenstring];if(_$Tokens.hasfunction(_tokenstring)){_tokenized=_$Tokens.functions[_tokenstring].call(_tokenconfig,_tokenized)}if(_$isFunction(_tokenized)){}else if(_$isObject(_tokenized)){if(Array.isArray(_tokenized)){_tokenized=_tokenized.join(_emptyString)}else{}}}if(_$Tokens.hasfunction(_tokenized)){var _functionDef=_$Tokens.fromStr(_tokenstring,"()"),_functionname=_functionDef[0],_parameters=_functionDef[1];iTrace(1,"call: ",_functionname,"(",_parameters,")");var _tokenfunctionResult=_$Tokens.functions[_functionname].call(_tokenconfig,_parameters);if(_$isString(_tokenfunctionResult)){iCSR.traceerror("Token function must return a String, called:",_functionname,_parameters)}}if(_tokenstring===_tokenized){var _object=_tokenstring.split(".");var _objectName=_object[0];if(_$hasProperty(_tokenconfig,_objectName)){var _objectKey=_object[1];_tokenized=_tokenconfig[_objectName][_objectKey]}else{if(iCSR.Str.alphanumeric(_tokenstring)===_tokenstring&&_islasttoken){_tokenized="["+_tokenstring+"]";iTrace(4,"replacetoken UNTOUCHED: ",_tokenized)}}}else{if(_tokenized)iTrace(3,"replacetoken:",_tokenstring,"\n==>",_tokenized)}}return _tokenized};_$Tokens._recursivereplace=function(_string,_tokenconfig){var _recursecount=0;var _previousreplacedtoken=_emptyString;function _recursivereplacetokens(_strpart){_recursecount++;if(_recursecount>1e3){return"**RECURSION LIMIT**"}for(var i=0;i<_strpart.length;i++){var _char=_strpart[i];var _token=_strpart.substr(0,i);var _remainder=_strpart.slice(i+1);var escape=_strpart[i-1]==="\\";if(escape){_strpart=_token.slice(0,i-1)+_char+_remainder;_char=false}if(!escape&&_char==="]"){var _replacedtoken=_emptyString;if(_token==="?"){if(_tokenconfig.templateid){_$Object.list(_tokenconfig,"Available tokens for: "+_tokenconfig.templateid)}}else{_previousreplacedtoken=_token;_replacedtoken=_$Tokens.replacetoken(_token,_tokenconfig,false)}if(_replacedtoken===_token){_strpart=_token+_remainder}else{return _recursivereplacetokens(_replacedtoken+_remainder)}}if(_char==="["){var _replacer=_recursivereplacetokens(_remainder);_strpart=_token+_replacer}}return _strpart}return _recursivereplacetokens(_string)};_$Tokens.replace=function(_string,_tokenconfig){_tokenconfig=_tokenconfig||this;return _$Tokens._recursivereplace(_string,_tokenconfig)};_$Tokens.ensureTokenexists=function(_token,_tokendefault){return _$Object._ensurevalue(this,_token,_tokendefault)};_$Tokens.functions.svgcircle=function(_circleSize,_circleColor){_circleColor=_circleColor||"[color]";var _radius=_circleSize/2;var _html="<svg height="+_circleSize+" width="+_circleSize+">";_html+="<circle cx="+_radius+" cy="+_radius+" r="+_radius+" fill='"+_circleColor+"'/>";_html+="</svg>";return _html};_$Tokens.functions.layoutsimage=function(_imagename){return"<img src='/layouts/images/"+iCSR.Str.alphanumeric(_imagename)+".gif'/>"};_$Tokens.hasfunction=function(_functionname){var _hasFunction=false;if(_$isString(_functionname)){_functionname=_functionname.split("(")[0];if(_$hasProperty(_$Tokens.functions,_functionname)){_hasFunction=true}}return _hasFunction};iCSR.Str.nobreak=function(_string){_string=_string||_emptyString;return _string.replace(/ /gi,"&nbsp;")};iCSR.Str.alphanumeric=function(_string,_replacer){return _string.replace(/[^a-z0-9+]+/gi,_replacer||_emptyString)};iCSR.Str.number=function(_string,_default){if(!_$isString(_string))return _string;var _value=_string.match(/\d+/);if(_value)return _value[0];return _default};iCSR.Str.label=function(value){var _valuemarker=") ",label=value&&value.indexOf(_valuemarker)>0?value.split(_valuemarker)[1]:value;return label};iCSR.Date.object=function(_date){if(_$isString(_date))_date=new Date(_date);_date=_date||new Date;_date={yyyy:_date.getFullYear(),MM:_date.getMonth()+1,dd:_date.getDate(),hh:_date.getHours(),mm:_date.getMinutes(),ss:_date.getSeconds()};_date.yy=String(_date.yyyy).substring(2);return _date};iCSR.Date.add=function(_date,_numberOfDays,_numberOfMonths,_numberOfYears){_date=_date||new Date;_date=iCSR.Date.object(_date);return new Date(_date.yyyy+(_numberOfYears?_numberOfYears:0),_date.MM+(_numberOfMonths?_numberOfMonths:0)-1,_date.dd+(_numberOfDays?_numberOfDays:0),_date.hh,_date.mm,_date.ss)};iCSR.Date.format=function(_date,_datestring){var isSP=true;_datestring=_datestring||"yyyy-MM-dd";_date=_date||new Date;if(isSP){return String.format("{0:"+_datestring+"}",_date)}_date=iCSR.Date.object(_date);for(var _datekey in _date){if(_$hasProperty(_date,_datekey)){var replacekey=new RegExp(_datekey,"g");_datestring=_datestring.replace(replacekey,_date[_datekey])}}return _datestring};iCSR.Date.diff=function(_date,_seconddate){_date=new Date(_date);if(_date instanceof Date&&!isNaN(_date.valueOf())){return GetDaysAfterToday(_date,_seconddate||new Date)}iTrace(4,"Incorrect Date conversion from:",_date);return false};iCSR.Array.ensure=function(_array,_separator){_separator=_separator||",";if(_$isString(_array)){if(_array===_emptyString)return[];_array=_array.split(_separator)}return _array};_$Object={isFunction:function(_obj){return _obj!==null&&typeof _obj==="function"},isArray:function(_obj){return _obj!==null&&typeof _obj==="array"},isWindow:function(_obj){return _obj!==null&&_obj===_obj.window},isNumeric:function(_obj){return!isNaN(parseFloat(_obj))&&isFinite(_obj)},type:function(_obj){if(_obj===null){return String(_obj)}return typeof _obj},isPlainObject:function(_obj){if(!_obj||_$Object.type(_obj)!=="object"||_obj.nodeType||_$Object.isWindow(_obj)){return false}try{if(_obj.constructor){return false}}catch(e){return false}var _key;for(_key in _obj){}return _key===undefined},isEmpty:function(_obj){return Object.keys(_obj).lenght<=0},extend:function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;i=2}if(typeof target!=="object"&&!_$Object.isFunction(target)){target={}}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!==null){for(name in options){if(_$hasProperty(options,name)){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(_$Object.isPlainObject(copy)||(copyIsArray=_$Object.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&_$Object.isArray(src)?src:[]}else{clone=src&&_$Object.isPlainObject(src)?src:{}}target[name]=_$Object.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}}return target}};_$Object.extendbyname=function(_objdestination,_objsource,_keys){_keys=_keys||Object.keys(_objsource);_keys=iCSR.Array.ensure(_keys);var _newsource={};_keys.forEach(function(_key){if(_$hasProperty(_objsource,_key)){_newsource[_key]=_objsource[_key]}else{_newsource[_key]="undefined";iTraceWarning(3,"Missing:",_key," in:",_objsource)}});_$Object.extend(_objdestination,_newsource)};_$Object.gettersetter=function(_obj,_configKey,_value){var _current=_obj[_configKey];if(_$isUndefined(_value)){return _current}if(_$hasProperty(_obj,_configKey)){_obj[_configKey]=_value}return _obj[_configKey]};_$Object._ensurevalue=function(_obj,_key,_defaultvalue){if(_$hasProperty(_obj,_key)){_defaultvalue=_obj[_key]}else{_obj[_key]=_defaultvalue}return _defaultvalue};_$Object.list=function(_obj,_title,_showtitleasfooter){if(_obj){_showtitleasfooter=_showtitleasfooter||_title;iTraceWarning("Object Inspector:",_title||_emptyString);if(_$Object.isEmpty(_obj)){iTraceWarning("Empty object")}else{Object.keys(_obj).forEach(function(key,nr){if(console)console.log(nr,key,_obj[key])})}iTraceWarning("Object Inspector:",_showtitleasfooter||_emptyString)}};iCSR.fn._get_configFrom_Colors=function(ctx,_config){if(_$isUndefined(_config.colors)||_config.colors===_emptyString){iTraceWarning("Empty .colors")}else{_config.colors=_$Tokens.replace(_config.colors,_config);_config.colors=iCSR.Color.extract(_config.colors,_config.Choices)}};iCSR.fn._get_configFrom_FieldType=function(ctx,_config){if(_config.FieldType==="DateTime"){var _Date=new Date(_config.value);_config.days=iCSR.Date.diff(_config.value);_config.datepickervalue=iCSR.Date.format(_Date,"yyyy-MM-dd");_config.absdays=Math.abs(_config.days);_config.Monthname=String.format("MMMM",_Date);_config.emptydate=isNaN(_config.days);if(_config.emptydate){_config.days=false;_config.absdays=false}}};iCSR.fn._get_configFrom_ctx=function(ctx,_config){if(ctx){_$Object.extendbyname(_config,ctx.CurrentFieldSchema,"Name,DisplayName,RealFieldName,FieldType,counter,Choices");_$Object._ensurevalue(_config,"Item",ctx.CurrentItem);_config.ID=ctx.CurrentItem.ID;_config.iid=GenerateIID(ctx);if(_$hasProperty(ctx.CurrentItem,_config.Name)){_config.value=ctx.CurrentItem[_config.Name]}else{_config.value=ctx.CurrentItem[_config.RealFieldName]}_config.itemid="iCSR_"+ctx.wpq+"_"+_config.ID;_config.daysCreated=iCSR.Date.diff(ctx.Created);_config.daysModified=iCSR.Date.diff(ctx.Modified);_config.urlEdit=ctx.editFormUrl+"&ID="+_config.ID;_config.urlDisplay=ctx.displayFormUrl+"&ID="+_config.ID}else{_config.ID="no ctx";_config.iid=false;_config.value="no ctx value"}};iCSR.fn._get_configFrom_pageContextInfo=function(_config){var _pageContext=window["_spPageContextInfo"];if(_pageContext){_$Object.extendbyname(_config,_pageContext,"userId,userLoginName,webPermMask,pageListId,isSiteAdmin,hasManageWebPermissions,siteAbsoluteUrl,serverRequestPath")}_config.urlList=_pageContext.serverRequestPath.replace(/[^\/]*$/gi,_emptyString)};iCSR.fn._get_configTemplate=function(ctx,_initialTemplateConfig,_bindTemplateConfig){var _config={templateid:_emptyString,ID:0,Name:"none",value:false,valuenr:false,label:false,shortlabel:false,id:0,itemid:"none",color:"poep",textcolor:"pies",colors:_emptyString};_bindTemplateConfig=_$hasProperty(_bindTemplateConfig,"FieldType")?{}:_bindTemplateConfig;_$Object.extend(_config,_initialTemplateConfig);
_$Object.extend(_config,_bindTemplateConfig);if(_$hasProperty(iCSR,"interactive")){_config.interactive=iCSR.interactive;if(_$hasProperty(_bindTemplateConfig,"interactive")){_config.interactive=_bindTemplateConfig.interactive}}iCSR.fn._get_configFrom_ctx(ctx,_config);iCSR.fn._get_configFrom_pageContextInfo(_config);_config.valuenr=Number(iCSR.Str.number(_config.value,false));_config.shortlabel=_config.valuenr?iCSR.Str.label(_config.value):_config.value;_config.label=_config.shortlabel;_config.nonbreaklabel=iCSR.Str.nobreak(_config.shortlabel);_config.emptystring=_config.value===_emptyString;iCSR.fn._get_configFrom_FieldType(ctx,_config);iCSR.fn._get_configFrom_Colors(ctx,_config);return _config};iCSR.fn._preprocessTemplate=function(_config){iTrace(3,"_preprocessTemplate",{output:_config.style});var _ispredefinedtemplate=_$hasProperty(_config.Styles,_config.style);var _templatestyle=_config.Styles.default;if(_ispredefinedtemplate){var _customtemplate=_config.Styles[_config.style];_$Object.extend(_templatestyle,_customtemplate)}else{if(_config.style)_templatestyle.item=_$Tokens.replace(_config.style)}_config.style=_templatestyle;return _templatestyle};iCSR.fn.addItem=function(_config){var _key=_config.Name;if(!_$hasProperty(iCSR.Items,_key)){iCSR.Items[_key]=[]}iCSR.Items[_key].push(_config.value)};_$CSS.appendHEADstyle=function(id){var _styleEl=document.createElement("STYLE");_styleEl.id=id;_styleEl.appendChild(document.createTextNode(_emptyString));document.head.appendChild(_styleEl);iTrace(2,"added stylesheet",_styleEl.id);return _styleEl};_$CSS.insertRuleinStyleSheet=function(_element,rule){if(_element){try{_element.sheet.insertRule(rule,0)}catch(e){iTraceWarning(1,"ignoring CSS definition:",rule)}}else{iCSR.traceerror("Not a STYLE sheet",_element)}};_$CSS.addStyleRules=function(id,rules){var _styleEl=_$getElementById(id);if(iCSR.ReloadCSSforeveryItem||!_styleEl){if(iCSR.ReloadCSSforeveryItem&&_styleEl){_$DOM.remove(_styleEl)}_styleEl=_$CSS.appendHEADstyle(id);rules.forEach(function(rule){_$CSS.insertRuleinStyleSheet(_styleEl,rule)})}};_$CSS._appendTemplateCSS=function(CSS,_config){var rules=_config.rules||[];CSS=CSS||false;if(_$isString(CSS)){CSS=_config.Styles[CSS]}if(CSS){Object.keys(CSS).forEach(function(key){rules.push(_$Tokens.replace(CSS[key],_config))});_$CSS.addStyleRules(_config.templateCSSid,rules,true);iTrace(2,"CSS:",CSS)}else{iCSR.traceerror("Missing CSS _config.Styles:",CSS)}return CSS};_$CSS.listRules=function(_templateCSSid){var _rulesArray=[];var _styleEl=_$getElementById(_templateCSSid);if(_styleEl){var _rules=_styleEl.sheet.cssRules;iTraceWarning("CSS Rules for: ",_templateCSSid);Object.keys(_rules).forEach(function(_rulenr){var _rule=_rules[_rulenr];if(console)console.log(_rulenr,_rule.cssText);_rulesArray.push(_rule.cssText)})}else{iTraceWarning("There is no CSS STYLE definition for:",_templateCSSid)}return _rulesArray};iCSR.SP.SPStatuscount=0;iCSR.SPStatus=function(_text,color,_title,first,_permanent){SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){var _SPUIStatus=SP.UI.Status;if(!_text||color===0){_SPUIStatus.removeAllStatus(true)}if(_text){var _SPStatusID;iCSR.SP.SPStatuscount++;if(iCSR.SP.SPStatuscount===10){_SPStatusID=_SPUIStatus.addStatus(_ICSR,"Too many errors",false);_SPUIStatus.setStatusPriColor(_SPStatusID,_RED)}else if(iCSR.SP.SPStatuscount<10){_SPStatusID=_SPUIStatus.addStatus(_title||_ICSR,_text,first||false);_SPUIStatus.setStatusPriColor(_SPStatusID,color||_YELLOW);if(!_permanent){window.setTimeout(function(){iCSR.SP.SPStatuscount--;_SPUIStatus.removeStatus(_SPStatusID)},5e3)}}}})};iCSR.SP.UpdateListItem=function(listID,ID,fieldname,value,norefreshView,_successFunc,_errorFunc){var e=event;e.preventDefault?e.preventDefault():e.returnValue=false;norefreshView=norefreshView||false;listID=listID||SP.ListOperation.Selection.getSelectedList();var context=SP.ClientContext.get_current();var list=context.get_web().get_lists().getById(listID);var item=list.getItemById(ID);context.load(item);item.set_item(fieldname,value);item.update();_successFunc=_successFunc||function(){iTrace(1,"success SP.UpdateListItem",ID,fieldname,value);if(!norefreshView)iCSR.SP.refreshView()};_errorFunc=_errorFunc||function(){try{var err=arguments[1];var errcode="err"+err.get_errorCode()/-1;var errormessage=err.get_message();var errormessages={err2130575162:"A validation rule prevents a Field change"};var failuremessage=err.get_errorDetails().get_itemFailure().get_message();if(errormessages.hasOwnProperty(errcode)){errormessage=errormessages[errcode];errormessage+=" : "+failuremessage}iCSR.SPStatus(errormessage,_RED,"Update",false,false);iCSR.traceerror("Error Updating",arguments);iCSR.SP.refreshView()}catch(e){iCSR.SPStatus(e.message,_RED,_ICSR,false,false);iCSR.SP.refreshView()}};context.executeQueryAsync(_successFunc,_errorFunc)};iCSR.SP.UpdateItem=function(element,ID,fieldname,value){var cell=GetAncestor(element,"TD");cell.style.opacity=".4";cell.style.pointer="wait";element.style.pointer="wait";iCSR.SP.UpdateListItem(false,ID,fieldname,value,false)};iCSR.SP.setAuthor=function(ID,authorID){var context=new SP.ClientContext.get_current,list=context.get_web().get_lists().getById(SP.ListOperation.Selection.getSelectedList()),item=list.getItemById(ID);context.load(item);item.set_item("Author",authorID);item.update();context.executeQueryAsync(function(){iCSR.SP.refreshView()},function(s,a){iCSR.traceerror(a.get_message())})};iCSR.SP.ClientContext=function(){return new SP.ClientContext.get_current};iCSR.SP.refreshView=function(context,refreshall){context=context||ctx;if(context){context.skipNextAnimation=!refreshall||true;AJAXRefreshView({currentCtx:context,csrAjaxRefresh:true},1)}};iCSR.SP.renderHeaderTemplate=function(renderCtx,fRenderHeaderColumnNames){var viewData=JSON.parse(renderCtx.ListSchema.ViewSelectorPivotMenuOptions);ClientPivotControl.prototype.SurfacedPivotCount=viewData.length-3;return RenderHeaderTemplate(renderCtx,fRenderHeaderColumnNames)};iCSR.SP.isGroupHeader=function(ctx){if(ctx)return _$hasProperty(ctx.CurrentItem,ctx.CurrentFieldSchema.Name+".COUNT.group")};iCSR.SP.enum=function(obj,func){if(!func)func=function(item){};var objects=[];var objEnumerator=obj.getEnumerator();while(objEnumerator.moveNext()){var item=objEnumerator.get_current();objects.push(item);func.call(this,item)}return objects};iCSR.SP.hasPermission=function(){for(var permLevelName in SP.PermissionKind.prototype){if(SP.PermissionKind.hasOwnProperty(permLevelName)){var permLevel=SP.PermissionKind.parse(permLevelName);var hasPermission=SP.PageContextInfo.get_webPermMasks().has(permLevel);iCSR.SP.hasPermission["has_"+permLevelName]=hasPermission}}};iCSR.SP.CAML={};iCSR.SP.CAML.FieldRef=function(Name,Ascending){return String.format("<FieldRef Name='{0}' Ascending='{1}' />",Name,Ascending?"TRUE":"FALSE")};iCSR.SP.get_approvallist=function(){function error(){console.error(arguments[1].get_message())}var approvalStatus=[[],[],[],[],[]],context=new SP.ClientContext.get_current,list=context.get_web().get_lists().getByTitle("DailyCartoon"),query=new SP.CamlQuery;var XMLformat="<View Scope='RecursiveAll'><Query><OrderBy><FieldRef Name='{0}' Ascending='{1}' /><FieldRef Name='{2}' Ascending='{3}' /></OrderBy></Query></View>";query.set_viewXml(String.format(XMLformat,"_ModerationStatus","TRUE","Modified","TRUE"));var items=list.getItems(query);context.load(items);context.executeQueryAsync(function(){var listEnumerator=items.getEnumerator();var lastapproval=new Date;var newapproval=false;while(listEnumerator.moveNext()){var file=listEnumerator.get_current(),filedata=file.get_fieldValues(),_ModerationStatus=filedata._ModerationStatus;console.info(_ModerationStatus,filedata.FileRef,filedata);if(_ModerationStatus!==0&&newapproval===false){newapproval=GetDaysAfterToday(lastapproval)<-7;if(newapproval){_ModerationStatus=0;file.set_item("_ModerationStatus",_ModerationStatus);file.set_item("_ModerationComments","Approved by DailyCartoon");file.update();context.executeQueryAsync(null,error)}}lastapproval=filedata.Modified;approvalStatus[_ModerationStatus].unshift(filedata)}console.info("Last Approved cartoon:",approvalStatus[0][0].FileRef)},error);console.clear();return approvalStatus};_$Tokens.functions.color=function(_color){var _config=this;if(_$isNumber(_color))_color=_config.colors[_color];var _colors=iCSR.Color._getcolorObject(_color,_config.textcolor);_config.combocolor=_color;_config.color=_colors.background;if(_colors.textcolor==="contrast"){var _contrastcolor=iCSR.Color.contrastcolor(_config.color);if(_contrastcolor)_colors.textcolor=_contrastcolor}_config.textcolor=_colors.textcolor;if(_colors.textcolor!==_INHERIT){_colors.background=_colors.background+";color:"+_config.textcolor+";"}return _colors.background};iCSR.Color._getcolorObject=function(_string,_textcolor){if(!_$isString(_string))_string=iCSR.Color._MISSING;var _colors=_string.split("/");if(_colors[1]){_textcolor=_colors[1]}else if(!_textcolor){_textcolor=_INHERIT}return{background:_colors[0],textcolor:_textcolor,border:_colors[2]}};iCSR.Color.contrastcolor=function(_color,_element){var _elementcolor=_color;var _contrastcolor=false;if(_element&&_elementcolor[0]!=="#"){_elementcolor=window.getComputedStyle(_element).backgroundColor;if(_elementcolor==="rgb(240, 36, 1)")_elementcolor="#000";if(_elementcolor==="rgba(0, 0, 0, 0)"){if(_color!=="none"&&_color!=="transparent"){_elementcolor=false}}}if(_elementcolor){_contrastcolor=iCSR.Color[iCSR.Color.contrast(_elementcolor)]}return _contrastcolor||false};iCSR.Color.extract=function(_colorObject,_choices){_choices=_choices||false;if(_choices===_UNDEFINED)_choices=false;if(_$isString(_colorObject)&&!_$isUndefined(_colorObject)){var _colors=_colorObject.split(",");if(!_choices){_colorObject=_colors}else{_colorObject={};for(var n=0;n<_choices.length;n++){var _choice=_choices[n],_color=_colors[n];if(!_color)_color="beige";_colorObject[_choice]=_color}}}return _colorObject};iCSR.Color.contrast=function(color){if(color===undefined||color===_emptyString){return null}var rgbExp=/^rgba?[\s+]?\(\s*(([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5]))\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,?(?:\s*([\d.]+))?\s*\)?\s*/im,hexExp=/^(?:#)|([a-fA-F0-9]{3}|[a-fA-F0-9]{6})$/gim,rgb=color.match(rgbExp),hex=color.match(hexExp),r,g,b,yiq;if(rgb){r=parseInt(rgb[1],10);g=parseInt(rgb[2],10);b=parseInt(rgb[3],10)}else if(hex){if(hex.length>1){hex=hex[1]}else{hex=hex[0]}if(hex.length===3){hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]}r=parseInt(hex.substr(0,2),16);g=parseInt(hex.substr(2,2),16);b=parseInt(hex.substr(4,2),16)}else{return null}yiq=(r*299+g*587+b*114)/1e3;return yiq>=128?"_CONTRASTDARK":"_CONTRASTLIGHT"};iCSR.Color.cell=function(_element,_colors){_element.style.backgroundColor=_colors.background;_element.style.color=_colors.textcolor};iCSR.Color.row=function(_element,_colors){var i,_elements=_element.getElementsByTagName("a");for(i=0;i<_elements.length;i++){_elements[i].style.color=_colors.textcolor}_elements=_element.getElementsByTagName("td");for(i=0;i<_elements.length;i++){iCSR.Color.cell(_elements[i],_colors)}};iCSR.DOM.style=function(_element,_options){Object.keys(_options).forEach(function(_key){var _property=_options[_key];if(_key===_BACKGROUND+"Color"){var _colors=iCSR.Color._getcolorObject(_property);_element.style.backgroundColor=_colors.background;window.setTimeout(function(){if(iCSR.Color._CONTRAST){_colors.textcolor=iCSR.Color.contrastcolor(_colors.background,_element)}if(_element.tagName==="TD"){iCSR.Color.cell(_element,_colors)}else{iCSR.Color.row(_element,_colors)}},10)}else{_element.style[_key]=_property}})};_$DOM.wait=function(id,_callback,_yieldtime){var _element=_$getElementById(id);if(_element){setTimeout(_callback.bind(null,_element),0)}else{if(_yieldtime<0){iCSR.traceerror("_$DOM.wait failed:",id)}else{setTimeout(_$DOM.wait.bind(null,id,_callback,_yieldtime-1),_yieldtime||100)}}};_$DOM.append=function(_parentelement,_html,_elementType,_className,_id){var _element=document.createElement(_elementType||"DIV");_element.innerHTML=_html;if(_className)_element.className=_className;if(_id)_element.id=_id;try{_parentelement.appendChild(_element)}catch(e){iTraceWarning("element not found:",_parentelement)}return _element};_$DOM._element=function(_element){return _$isString(_element)?_$getElementById(_element):_element};_$DOM.show=function(_element){_$DOM._element(_element).style.display="table-row"};_$DOM.hide=function(_element){_$DOM._element(_element).style.display="none"};_$DOM.toggle=function(_element){_element=_$DOM._element(_element);_element.style.display=_element.style.display==="none"?"table-row":"none"};_$DOM.remove=function(_element){_$DOM._element(_element).parentNode.removeChild(_element)};_$DOM.hidefooter=function(){_$DOM.hide("iCSRfooter")};_$DOM.footer=function(message){message=message||"Download iCSR.js from iCSR.github.io ► the iCSR.js file you linked to is for demo use only! ( version: "+iCSR._VERSION+" )";var demoCSS=["body::after{color:#FCD500;background:#005AA9;content:'"+message+"';position:fixed;bottom:30px;width:100%;left:0px;font-size:16px;text-align:center;}",".iCSRlogo {position:fixed;bottom:50px;left:10px;width:96px;height:96px;z-index:1}",".helplinks {width:300px}"];_$CSS.addStyleRules(_ICSR,demoCSS);var helplinks="<h3>Support Links:</h3>";helplinks+="<a href='https://github.com/365CSI/iCSR/blob/master/CSR-5-minute-quickstart.md' target='_new'>iCSR Quickstart</a>";helplinks+="<br><a href='http://iCSR.github.io' target='_new'>iCSR on GitHub</a>";helplinks+="<br><a href='javascript:icColors' target='_new'>HTML colornames</a>";helplinks="<div class='helplinks'>"+helplinks+"</div>";var html="<table><tr><td><img src='https://365csi.nl/icsr/ipcountlogo'  onclick='iCSR.DOM.hidefooter();'></td>";html+="<td valign='top'>"+helplinks+"</td></tr></table>";_spYield(function(){_$DOM.append(iCSR.DOM._element("contentRow"),'<div style="height:10em;"></div>',"DIV","","iCSRsleeve");_$DOM.append(document.body,html,"DIV","iCSRlogo","iCSRfooter")},200)};iCSR.Object.info=function(_obj,fieldnames){var fields={};_obj.forEach(function(field){var fieldinfo={};(fieldnames||"nofieldnames").split(",").forEach(function(prop){var _text=field[prop];if(prop==="Name"&&iCSR.$hasTemplate(_text,true))_text+=" ==> iCSR.Me";fieldinfo[prop]=_text});fields[field.counter]=fieldinfo});return fields};iCSR.defineProperty=function(_name,_obj,_function){_obj=_obj||window;if(!_$hasProperty(_obj,_name)){Object.defineProperty(_obj,String(_name),{get:_function})}};iCSR.addChromeBrowserTools=function(){var _icColors="icColors";iCSR.defineProperty(_icColors,window,function(){if(_$getElementById(_icColors)){iCSR.DOM.remove(_$getElementById(_icColors))}else{console.clear();var H="<DIV id="+_icColors+" style='z-index:99;background:beige;position:fixed;top:0;left:0;font-family:arial;font-weight:bold;width:870px'>";H+="<DIV onclick='iCSR.DOM.remove(this.parentNode)'><h1>Click this title to close. Doubleclick colorname or #value to copy</h1></DIV>";Object.keys(iCSR.colornames).forEach(function(name){var value=iCSR.colornames[name];H+="<DIV style=float:left;text-align:center;width:120px;height:35px;background:"+value+";margin:1px;color:"+iCSR.Color.contrastcolor(value)+">";H+=name+"<DIV style=text-transform:uppercase;font-size:90%>"+value+"</DIV></DIV>"});iCSR.DOM.append(_$getElementById("DeltaPlaceHolderMain"),H+"<DIV></DIV></DIV>")}});if(!window.icCTX){Object.defineProperty(window,"icCTX",{get:function(){return console.table(iCSR.Object.info(ctx.ListSchema.Field,"DisplayName,Name,RealFieldName,FieldType"))}})}if(!window.icTemplates){Object.defineProperty(window,"icTemplates",{get:function(){iCSR._Templates.forEach(function(_templateIDname){var _config=iCSR[_templateIDname].configuration;_$Object.list(_config.Styles,_config.templateid+" has "+Object.keys(_config.Styles).length+" predefined Styles:")})}})}if(!window.cls){Object.defineProperty(window,"cls",{configurable:true,get:function(){console.clear();return _emptyString}})}};iCSR.overrides=function(_overrides){_overrides=_overrides||{};_$Object._ensurevalue(_overrides,"Templates",{});_$Object._ensurevalue(_overrides.Templates,"Fields",{});_overrides.Templates.Fields.Priority={View:iCSR.Me};_overrides.Templates.Fields.DueDate={View:iCSR.Me};_overrides.Templates.Fields.Status={View:iCSR.Me};_overrides.Templates.Fields.PercentComplete={View:iCSR.Me};return _overrides};iCSR.colornames={white:"#ffffff",gainsboro:"#dcdcdc",silver:"#c0c0c0",darkgray:"#a9a9a9",gray:"#808080",dimgray:"#696969",black:"#000000",whitesmoke:"#f5f5f5",lightgray:"#d3d3d3",lightcoral:"#f08080",rosybrown:"#bc8f8f",indianred:"#cd5c5c",red:"#ff0000",maroon:"#800000",snow:"#fffafa",mistyrose:"#ffe4e1",salmon:"#fa8072",orangered:"#ff4500",chocolate:"#d2691e",brown:"#a52a2a",darkred:"#8b0000",seashell:"#fff5ee",peachpuff:"#ffdab9",tomato:"#ff6347",darkorange:"#ff8c00",peru:"#cd853f",firebrick:"#b22222",olive:"#808000",linen:"#faf0e6",bisque:"#ffe4c4",darksalmon:"#e9967a",orange:"#ffa500",goldenrod:"#daa520",sienna:"#a0522d",darkolivegreen:"#556b2f",oldlace:"#fdf5e6",antiquewhite:"#faebd7",coral:"#ff7f50",gold:"#ffd700",limegreen:"#32cd32",saddlebrown:"#8b4513",darkgreen:"#006400",floralwhite:"#fffaf0",navajowhite:"#ffdead",lightsalmon:"#ffa07a",darkkhaki:"#bdb76b",lime:"#00ff00",darkgoldenrod:"#b8860b",green:"#008000",cornsilk:"#fff8dc",blanchedalmond:"#ffebcd",sandybrown:"#f4a460",yellow:"#ffff00",mediumseagreen:"#3cb371",olivedrab:"#6b8e23",forestgreen:"#228b22",ivory:"#fffff0",papayawhip:"#ffefd5",burlywood:"#deb887",yellowgreen:"#9acd32",springgreen:"#00ff7f",seagreen:"#2e8b57",darkslategray:"#2f4f4f",beige:"#f5f5dc",moccasin:"#ffe4b5",tan:"#d2b48c",chartreuse:"#7fff00",mediumspringgreen:"#00fa9a",lightseagreen:"#20b2aa",teal:"#008080",lightyellow:"#ffffe0",wheat:"#f5deb3",khaki:"#f0e68c",lawngreen:"#7cfc00",aqua:"#00ffff",darkturquoise:"#00ced1",darkcyan:"#008b8b",lightgoldenrodyellow:"#fafad2",lemonchiffon:"#fffacd",greenyellow:"#adff2f",darkseagreen:"#8fbc8f",cyan:"#00ffff",deepskyblue:"#00bfff",midnightblue:"#191970",honeydew:"#f0fff0",palegoldenrod:"#eee8aa",lightgreen:"#90ee90",mediumaquamarine:"#66cdaa",cadetblue:"#5f9ea0",steelblue:"#4682b4",navy:"#000080",mintcream:"#f5fffa",palegreen:"#98fb98",skyblue:"#87ceeb",turquoise:"#40e0d0",dodgerblue:"#1e90ff",blue:"#0000ff",darkblue:"#00008b",azure:"#f0ffff",aquamarine:"#7fffd4",lightskyblue:"#87cefa",mediumturquoise:"#48d1cc",lightslategray:"#778899",blueviolet:"#8a2be2",mediumblue:"#0000cd",lightcyan:"#e0ffff",paleturquoise:"#afeeee",lightsteelblue:"#b0c4de",cornflowerblue:"#6495ed",slategray:"#708090",darkorchid:"#9932cc",darkslateblue:"#483d8b",aliceblue:"#f0f8ff",powderblue:"#b0e0e6",thistle:"#d8bfd8",mediumslateblue:"#7b68ee",royalblue:"#4169e1",fuchsia:"#ff00ff",indigo:"#4b0082",ghostwhite:"#f8f8ff",lightblue:"#add8e6",plum:"#dda0dd",mediumpurple:"#9370db",slateblue:"#6a5acd",magenta:"#ff00ff",darkviolet:"#9400d3",lavender:"#e6e6fa",pink:"#ffc0cb",violet:"#ee82ee",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumvioletred:"#c71585",purple:"#800080",lavenderblush:"#fff0f5",lightpink:"#ffb6c1",hotpink:"#ff69b4",palevioletred:"#db7093",deeppink:"#ff1493",crimson:"#dc143c",darkmagenta:"#8b008b"};function isDEMOlibrary(){if(_v_dictSod.hasOwnProperty(_ICSR)&&_v_dictSod[_ICSR].url.indexOf("365csi.nl")>-1)return true;if(document.querySelector("script[src^='https://365csi.nl/icsr']"))return true;return false}iCSR.isChrome=browseris.chrome;if(iCSR.isChrome)iCSR.addChromeBrowserTools();iCSR.is365CSIlibrary=isDEMOlibrary();iCSR._traceheader(false);iCSR._RegisterDefaultTemplates();if(iCSR.is365CSIlibrary)_$DOM.footer();SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs(_ICSR)})(window,document);